{
  "tools": [
    {
      "name": "grist_get_workspaces",
      "title": "Get Workspaces",
      "description": "List accessible workspaces",
      "inputSchema": {
        "type": "object",
        "properties": {
          "name_contains": {
            "description": "Optional: Filter workspaces by name. Case-insensitive partial matching. Example: 'Sales' matches 'Sales Team', 'Regional Sales', etc. Leave empty to list all accessible workspaces.",
            "type": "string",
            "minLength": 1,
            "maxLength": 100
          },
          "detail_level": {
            "description": "\"summary\": Name, ID, doc count only. \"detailed\": + permissions, timestamps, full metadata",
            "default": "summary",
            "type": "string",
            "enum": [
              "summary",
              "detailed"
            ]
          },
          "response_format": {
            "description": "Output format: \"json\" for structured data, \"markdown\" for human-readable text",
            "default": "markdown",
            "type": "string",
            "enum": [
              "json",
              "markdown"
            ]
          },
          "offset": {
            "description": "Starting position (0-indexed) for pagination",
            "default": 0,
            "type": "integer",
            "minimum": 0,
            "maximum": 9007199254740991
          },
          "limit": {
            "description": "Number of items to return (min: 1, max: 1000)",
            "default": 100,
            "type": "integer",
            "minimum": 1,
            "maximum": 1000
          }
        },
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "id": {
                  "description": "Workspace ID",
                  "anyOf": [
                    {
                      "type": "string"
                    },
                    {
                      "type": "number"
                    }
                  ]
                },
                "name": {
                  "description": "Workspace name",
                  "type": "string"
                },
                "org": {
                  "description": "Organization name or ID",
                  "anyOf": [
                    {
                      "type": "string"
                    },
                    {
                      "type": "number"
                    }
                  ]
                },
                "org_domain": {
                  "description": "Organization domain",
                  "type": "string"
                },
                "doc_count": {
                  "description": "Number of documents",
                  "type": "number"
                },
                "access": {
                  "description": "Access level",
                  "type": "string"
                },
                "created_at": {
                  "description": "Creation timestamp",
                  "type": "string"
                },
                "updated_at": {
                  "description": "Last update timestamp",
                  "type": "string"
                }
              },
              "required": [
                "id",
                "name",
                "doc_count",
                "access"
              ],
              "additionalProperties": false
            }
          },
          "total": {
            "type": "number"
          },
          "offset": {
            "type": "number"
          },
          "limit": {
            "type": "number"
          },
          "has_more": {
            "type": "boolean"
          },
          "next_offset": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ]
          }
        },
        "required": [
          "items",
          "total",
          "offset",
          "limit",
          "has_more",
          "next_offset"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "annotations": {
        "readOnlyHint": true,
        "destructiveHint": false,
        "idempotentHint": true,
        "openWorldHint": true
      },
      "execution": {
        "taskSupport": "forbidden"
      }
    },
    {
      "name": "grist_get_documents",
      "title": "Get Documents",
      "description": "Find documents by ID, name, or workspace",
      "inputSchema": {
        "type": "object",
        "properties": {
          "docId": {
            "description": "Optional: Get specific document by ID. If provided, returns single document. Example: 'qBbArddFDSrKd2jpv3uZTj'",
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "pattern": "^[1-9A-HJ-NP-Za-km-z]{22}$"
          },
          "name_contains": {
            "description": "Optional: Search documents by name. Case-insensitive partial matching. Example: 'CRM' matches 'Customer CRM', 'Sales CRM System', etc. Leave empty to list all accessible documents.",
            "type": "string",
            "minLength": 1,
            "maxLength": 100
          },
          "workspaceId": {
            "description": "Optional: Filter to documents in specific workspace. Example: 'ws_123' or '3' (numeric ID)",
            "type": "integer",
            "exclusiveMinimum": 0,
            "maximum": 9007199254740991
          },
          "detail_level": {
            "description": "Control metadata depth:\n- summary: name, id, workspace (fast, minimal tokens)\n- detailed: + permissions, timestamps, urls",
            "default": "summary",
            "type": "string",
            "enum": [
              "summary",
              "detailed"
            ]
          },
          "response_format": {
            "description": "Output format: \"json\" for structured data, \"markdown\" for human-readable text",
            "default": "markdown",
            "type": "string",
            "enum": [
              "json",
              "markdown"
            ]
          },
          "offset": {
            "description": "Starting position (0-indexed) for pagination",
            "default": 0,
            "type": "integer",
            "minimum": 0,
            "maximum": 9007199254740991
          },
          "limit": {
            "description": "Number of items to return (min: 1, max: 1000)",
            "default": 100,
            "type": "integer",
            "minimum": 1,
            "maximum": 1000
          }
        },
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "items": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "id": {
                  "description": "Document ID",
                  "type": "string"
                },
                "name": {
                  "description": "Document name",
                  "type": "string"
                },
                "workspace": {
                  "description": "Workspace name or details",
                  "anyOf": [
                    {
                      "type": "string"
                    },
                    {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "number"
                        },
                        "name": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "id",
                        "name"
                      ],
                      "additionalProperties": false
                    }
                  ]
                },
                "workspace_id": {
                  "description": "Workspace ID",
                  "anyOf": [
                    {
                      "type": "number"
                    },
                    {
                      "type": "string"
                    }
                  ]
                },
                "access": {
                  "description": "Access level",
                  "type": "string"
                },
                "url": {
                  "description": "Document URL",
                  "type": "string"
                },
                "is_pinned": {
                  "description": "Whether document is pinned",
                  "type": "boolean"
                },
                "created_at": {
                  "description": "Creation timestamp",
                  "type": "string"
                },
                "updated_at": {
                  "description": "Last update timestamp",
                  "type": "string"
                },
                "public": {
                  "description": "Whether document is public",
                  "type": "boolean"
                }
              },
              "required": [
                "id",
                "name",
                "access"
              ],
              "additionalProperties": false
            }
          },
          "total": {
            "type": "number"
          },
          "offset": {
            "type": "number"
          },
          "limit": {
            "type": "number"
          },
          "has_more": {
            "type": "boolean"
          },
          "next_offset": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ]
          }
        },
        "required": [
          "items",
          "total",
          "offset",
          "limit",
          "has_more",
          "next_offset"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "annotations": {
        "readOnlyHint": true,
        "destructiveHint": false,
        "idempotentHint": true,
        "openWorldHint": true
      },
      "execution": {
        "taskSupport": "forbidden"
      }
    },
    {
      "name": "grist_get_tables",
      "title": "Get Grist Table Structure",
      "description": "Get table and column schema",
      "inputSchema": {
        "type": "object",
        "properties": {
          "docId": {
            "description": "Document ID from grist_get_documents. Examples: \"aKt7TZe8YGLp3ak8bDL8TZ\", \"qBbArddFDSrKd2jpv3uZTj\", \"xYz9123AbcDef456Ghi78J\"",
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "pattern": "^[1-9A-HJ-NP-Za-km-z]{22}$"
          },
          "tableId": {
            "description": "Table name from grist_get_tables. Examples: \"Contacts\", \"Sales_Data\", \"Projects\", \"Inventory\", \"Customers\"",
            "type": "string",
            "minLength": 1,
            "maxLength": 64,
            "pattern": "^[A-Z_][A-Za-z0-9_]*$"
          },
          "detail_level": {
            "description": "\"names\": Table names only. \"columns\": + column names. \"full_schema\": + types, formulas, widgetOptions",
            "default": "columns",
            "type": "string",
            "enum": [
              "names",
              "columns",
              "full_schema"
            ]
          },
          "response_format": {
            "description": "Output format: \"json\" for structured data, \"markdown\" for human-readable text",
            "default": "markdown",
            "type": "string",
            "enum": [
              "json",
              "markdown"
            ]
          },
          "offset": {
            "description": "Starting position (0-indexed) for pagination",
            "default": 0,
            "type": "integer",
            "minimum": 0,
            "maximum": 9007199254740991
          },
          "limit": {
            "description": "Number of items to return (min: 1, max: 1000)",
            "default": 100,
            "type": "integer",
            "minimum": 1,
            "maximum": 1000
          }
        },
        "required": [
          "docId"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "document_id": {
            "description": "Document ID",
            "type": "string"
          },
          "table_count": {
            "description": "Number of tables in response",
            "type": "number"
          },
          "items": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "id": {
                  "description": "Table ID",
                  "type": "string"
                },
                "columns": {
                  "description": "Column names or full column details",
                  "anyOf": [
                    {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    },
                    {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "description": "Column ID",
                            "type": "string"
                          },
                          "label": {
                            "description": "Column label",
                            "type": "string"
                          },
                          "type": {
                            "description": "Column type",
                            "type": "string"
                          },
                          "is_formula": {
                            "description": "Whether column is a formula",
                            "type": "boolean"
                          },
                          "formula": {
                            "description": "Formula expression if applicable",
                            "anyOf": [
                              {
                                "type": "string"
                              },
                              {
                                "type": "null"
                              }
                            ]
                          },
                          "widget_options": {
                            "description": "Widget options",
                            "anyOf": [
                              {
                                "type": "string"
                              },
                              {
                                "type": "object",
                                "propertyNames": {
                                  "type": "string"
                                },
                                "additionalProperties": {}
                              },
                              {
                                "type": "null"
                              }
                            ]
                          },
                          "visible_col": {
                            "description": "Visible column ID for references",
                            "anyOf": [
                              {
                                "type": "number"
                              },
                              {
                                "type": "null"
                              }
                            ]
                          },
                          "visible_col_name": {
                            "description": "Visible column name for references",
                            "anyOf": [
                              {
                                "type": "string"
                              },
                              {
                                "type": "null"
                              }
                            ]
                          }
                        },
                        "required": [
                          "id",
                          "label",
                          "type",
                          "is_formula",
                          "formula",
                          "widget_options"
                        ],
                        "additionalProperties": false
                      }
                    }
                  ]
                }
              },
              "required": [
                "id"
              ],
              "additionalProperties": false
            }
          },
          "total": {
            "type": "number"
          },
          "offset": {
            "type": "number"
          },
          "limit": {
            "type": "number"
          },
          "has_more": {
            "type": "boolean"
          },
          "next_offset": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ]
          },
          "page_number": {
            "type": "number"
          },
          "total_pages": {
            "type": "number"
          },
          "items_in_page": {
            "type": "number"
          }
        },
        "required": [
          "document_id",
          "table_count",
          "items",
          "total",
          "offset",
          "limit",
          "has_more",
          "next_offset",
          "page_number",
          "total_pages",
          "items_in_page"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "annotations": {
        "readOnlyHint": true,
        "destructiveHint": false,
        "idempotentHint": true,
        "openWorldHint": true
      },
      "execution": {
        "taskSupport": "forbidden"
      }
    },
    {
      "name": "grist_query_sql",
      "title": "Query Grist with SQL",
      "description": "Execute SQL for JOINs, aggregations, and complex queries",
      "inputSchema": {
        "type": "object",
        "properties": {
          "docId": {
            "description": "Document ID from grist_get_documents. Examples: \"aKt7TZe8YGLp3ak8bDL8TZ\", \"qBbArddFDSrKd2jpv3uZTj\", \"xYz9123AbcDef456Ghi78J\"",
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "pattern": "^[1-9A-HJ-NP-Za-km-z]{22}$"
          },
          "sql": {
            "description": "SQL query to execute. Supports SELECT, JOINs, WHERE, GROUP BY, ORDER BY. Table names should match Grist table IDs. Example: \"SELECT Name, Email FROM Contacts WHERE Status = 'Active'\"",
            "type": "string",
            "minLength": 1,
            "maxLength": 10000
          },
          "parameters": {
            "description": "Optional parameterized query values. Use ? placeholders in SQL (SQLite style). Example SQL: \"WHERE Status = ? AND Priority > ?\" with parameters: [\"Active\", 1]",
            "type": "array",
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "number"
                },
                {
                  "type": "boolean"
                },
                {
                  "type": "null"
                }
              ]
            }
          },
          "response_format": {
            "description": "Output format: \"json\" for structured data, \"markdown\" for human-readable text",
            "default": "markdown",
            "type": "string",
            "enum": [
              "json",
              "markdown"
            ]
          },
          "offset": {
            "description": "Starting position (0-indexed) for pagination",
            "default": 0,
            "type": "integer",
            "minimum": 0,
            "maximum": 9007199254740991
          },
          "limit": {
            "description": "Number of items to return (min: 1, max: 1000)",
            "default": 100,
            "type": "integer",
            "minimum": 1,
            "maximum": 1000
          }
        },
        "required": [
          "docId",
          "sql"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "records": {
            "description": "Query result rows",
            "type": "array",
            "items": {
              "type": "object",
              "propertyNames": {
                "type": "string"
              },
              "additionalProperties": {}
            }
          },
          "total": {
            "type": "number"
          },
          "offset": {
            "type": "number"
          },
          "limit": {
            "type": "number"
          },
          "has_more": {
            "type": "boolean"
          },
          "next_offset": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ]
          }
        },
        "required": [
          "records",
          "total",
          "offset",
          "limit",
          "has_more",
          "next_offset"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "annotations": {
        "readOnlyHint": true,
        "destructiveHint": false,
        "idempotentHint": true,
        "openWorldHint": true
      },
      "execution": {
        "taskSupport": "forbidden"
      }
    },
    {
      "name": "grist_get_records",
      "title": "Get Grist Records",
      "description": "Fetch records with optional filters",
      "inputSchema": {
        "type": "object",
        "properties": {
          "docId": {
            "description": "Document ID from grist_get_documents. Examples: \"aKt7TZe8YGLp3ak8bDL8TZ\", \"qBbArddFDSrKd2jpv3uZTj\", \"xYz9123AbcDef456Ghi78J\"",
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "pattern": "^[1-9A-HJ-NP-Za-km-z]{22}$"
          },
          "tableId": {
            "description": "Table name from grist_get_tables. Examples: \"Contacts\", \"Sales_Data\", \"Projects\", \"Inventory\", \"Customers\"",
            "type": "string",
            "minLength": 1,
            "maxLength": 64,
            "pattern": "^[A-Z_][A-Za-z0-9_]*$"
          },
          "filters": {
            "description": "Filter by column values. Ex: {\"Status\": \"Active\"}, {\"Priority\": [1,2]}",
            "type": "object",
            "propertyNames": {
              "type": "string"
            },
            "additionalProperties": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "number"
                },
                {
                  "type": "boolean"
                },
                {
                  "type": "null"
                },
                {
                  "type": "array",
                  "items": {
                    "anyOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "number"
                      },
                      {
                        "type": "boolean"
                      },
                      {
                        "type": "null"
                      }
                    ]
                  }
                }
              ]
            }
          },
          "columns": {
            "description": "Columns to return. Omit for all. Ex: [\"Name\", \"Email\"]",
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "response_format": {
            "description": "Output format: \"json\" for structured data, \"markdown\" for human-readable text",
            "default": "markdown",
            "type": "string",
            "enum": [
              "json",
              "markdown"
            ]
          },
          "offset": {
            "description": "Starting position (0-indexed) for pagination",
            "default": 0,
            "type": "integer",
            "minimum": 0,
            "maximum": 9007199254740991
          },
          "limit": {
            "description": "Number of items to return (min: 1, max: 1000)",
            "default": 100,
            "type": "integer",
            "minimum": 1,
            "maximum": 1000
          }
        },
        "required": [
          "docId",
          "tableId"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "document_id": {
            "description": "Document ID",
            "type": "string"
          },
          "table_id": {
            "description": "Table ID",
            "type": "string"
          },
          "items": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "id": {
                  "description": "Row ID",
                  "type": "number"
                }
              },
              "required": [
                "id"
              ],
              "additionalProperties": false
            }
          },
          "total": {
            "type": "number"
          },
          "offset": {
            "type": "number"
          },
          "limit": {
            "type": "number"
          },
          "has_more": {
            "type": "boolean"
          },
          "next_offset": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ]
          },
          "filters": {
            "description": "Applied filters",
            "type": "object",
            "propertyNames": {
              "type": "string"
            },
            "additionalProperties": {}
          },
          "columns": {
            "description": "Selected columns",
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            ]
          },
          "formula_errors": {
            "description": "Formula error summary if any",
            "type": "object",
            "properties": {
              "records_with_errors": {
                "description": "Count of records with formula errors",
                "type": "number"
              },
              "affected_columns": {
                "description": "Columns with errors",
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            },
            "required": [
              "records_with_errors",
              "affected_columns"
            ],
            "additionalProperties": false
          }
        },
        "required": [
          "document_id",
          "table_id",
          "items",
          "total",
          "offset",
          "limit",
          "has_more",
          "next_offset"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "annotations": {
        "readOnlyHint": true,
        "destructiveHint": false,
        "idempotentHint": true,
        "openWorldHint": true
      },
      "execution": {
        "taskSupport": "forbidden"
      }
    },
    {
      "name": "grist_add_records",
      "title": "Add Grist Records",
      "description": "Insert new records",
      "inputSchema": {
        "type": "object",
        "properties": {
          "docId": {
            "description": "Document ID from grist_get_documents. Examples: \"aKt7TZe8YGLp3ak8bDL8TZ\", \"qBbArddFDSrKd2jpv3uZTj\", \"xYz9123AbcDef456Ghi78J\"",
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "pattern": "^[1-9A-HJ-NP-Za-km-z]{22}$"
          },
          "tableId": {
            "description": "Table name from grist_get_tables. Examples: \"Contacts\", \"Sales_Data\", \"Projects\", \"Inventory\", \"Customers\"",
            "type": "string",
            "minLength": 1,
            "maxLength": 64,
            "pattern": "^[A-Z_][A-Za-z0-9_]*$"
          },
          "records": {
            "description": "Array of record objects to add (max 500). Each object maps column IDs to values. Example: [{\"Name\": \"John\", \"Email\": \"john@example.com\"}]",
            "minItems": 1,
            "maxItems": 500,
            "type": "array",
            "items": {
              "type": "object",
              "propertyNames": {
                "type": "string"
              },
              "additionalProperties": {
                "anyOf": [
                  {
                    "description": "Empty cell",
                    "type": "null"
                  },
                  {
                    "description": "Text value. For dates use ISO 8601: \"2024-01-15\" or \"2024-01-15T10:30:00Z\"",
                    "type": "string"
                  },
                  {
                    "description": "Numeric value. For Ref columns, use row ID directly",
                    "type": "number"
                  },
                  {
                    "description": "True or false",
                    "type": "boolean"
                  },
                  {
                    "description": "List of values for ChoiceList or RefList columns",
                    "type": "array",
                    "items": {
                      "anyOf": [
                        {
                          "type": "string"
                        },
                        {
                          "type": "number"
                        },
                        {
                          "type": "boolean"
                        }
                      ]
                    }
                  }
                ]
              }
            }
          },
          "response_format": {
            "description": "Output format: \"json\" for structured data, \"markdown\" for human-readable text",
            "default": "markdown",
            "type": "string",
            "enum": [
              "json",
              "markdown"
            ]
          }
        },
        "required": [
          "docId",
          "tableId",
          "records"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "const": true
          },
          "document_id": {
            "description": "Document ID",
            "type": "string"
          },
          "table_id": {
            "description": "Table ID",
            "type": "string"
          },
          "records_added": {
            "description": "Number of records added",
            "type": "number"
          },
          "record_ids": {
            "description": "IDs of added rows",
            "type": "array",
            "items": {
              "type": "number"
            }
          },
          "message": {
            "description": "Success message",
            "type": "string"
          }
        },
        "required": [
          "success",
          "document_id",
          "table_id",
          "records_added",
          "record_ids"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "annotations": {
        "readOnlyHint": false,
        "destructiveHint": false,
        "idempotentHint": false,
        "openWorldHint": true
      },
      "execution": {
        "taskSupport": "forbidden"
      }
    },
    {
      "name": "grist_update_records",
      "title": "Update Grist Records",
      "description": "Update existing records by row ID",
      "inputSchema": {
        "type": "object",
        "properties": {
          "docId": {
            "description": "Document ID from grist_get_documents. Examples: \"aKt7TZe8YGLp3ak8bDL8TZ\", \"qBbArddFDSrKd2jpv3uZTj\", \"xYz9123AbcDef456Ghi78J\"",
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "pattern": "^[1-9A-HJ-NP-Za-km-z]{22}$"
          },
          "tableId": {
            "description": "Table name from grist_get_tables. Examples: \"Contacts\", \"Sales_Data\", \"Projects\", \"Inventory\", \"Customers\"",
            "type": "string",
            "minLength": 1,
            "maxLength": 64,
            "pattern": "^[A-Z_][A-Za-z0-9_]*$"
          },
          "rowIds": {
            "description": "Array of row IDs to operate on (max 500 per request). Get row IDs from grist_get_records",
            "minItems": 1,
            "maxItems": 500,
            "type": "array",
            "items": {
              "type": "integer",
              "exclusiveMinimum": 0,
              "maximum": 9007199254740991
            }
          },
          "updates": {
            "description": "Object mapping column IDs to new values. Example: {\"Status\": \"Complete\", \"UpdatedDate\": \"2024-01-15\"}",
            "type": "object",
            "propertyNames": {
              "type": "string"
            },
            "additionalProperties": {
              "anyOf": [
                {
                  "description": "Empty cell",
                  "type": "null"
                },
                {
                  "description": "Text value. For dates use ISO 8601: \"2024-01-15\" or \"2024-01-15T10:30:00Z\"",
                  "type": "string"
                },
                {
                  "description": "Numeric value. For Ref columns, use row ID directly",
                  "type": "number"
                },
                {
                  "description": "True or false",
                  "type": "boolean"
                },
                {
                  "description": "List of values for ChoiceList or RefList columns",
                  "type": "array",
                  "items": {
                    "anyOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "number"
                      },
                      {
                        "type": "boolean"
                      }
                    ]
                  }
                }
              ]
            }
          },
          "response_format": {
            "description": "Output format: \"json\" for structured data, \"markdown\" for human-readable text",
            "default": "markdown",
            "type": "string",
            "enum": [
              "json",
              "markdown"
            ]
          }
        },
        "required": [
          "docId",
          "tableId",
          "rowIds",
          "updates"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "const": true
          },
          "document_id": {
            "description": "Document ID",
            "type": "string"
          },
          "table_id": {
            "description": "Table ID",
            "type": "string"
          },
          "records_updated": {
            "description": "Number of records updated",
            "type": "number"
          },
          "message": {
            "description": "Success message",
            "type": "string"
          }
        },
        "required": [
          "success",
          "document_id",
          "table_id",
          "records_updated"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "annotations": {
        "readOnlyHint": false,
        "destructiveHint": false,
        "idempotentHint": true,
        "openWorldHint": true
      },
      "execution": {
        "taskSupport": "forbidden"
      }
    },
    {
      "name": "grist_upsert_records",
      "title": "Upsert Grist Records",
      "description": "Add or update records by unique key (idempotent sync)",
      "inputSchema": {
        "type": "object",
        "properties": {
          "docId": {
            "description": "Document ID from grist_get_documents. Examples: \"aKt7TZe8YGLp3ak8bDL8TZ\", \"qBbArddFDSrKd2jpv3uZTj\", \"xYz9123AbcDef456Ghi78J\"",
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "pattern": "^[1-9A-HJ-NP-Za-km-z]{22}$"
          },
          "tableId": {
            "description": "Table name from grist_get_tables. Examples: \"Contacts\", \"Sales_Data\", \"Projects\", \"Inventory\", \"Customers\"",
            "type": "string",
            "minLength": 1,
            "maxLength": 64,
            "pattern": "^[A-Z_][A-Za-z0-9_]*$"
          },
          "records": {
            "description": "Array of record objects to upsert (max 500). Each record has 'require' (fields to match) and 'fields' (fields to update/add).",
            "minItems": 1,
            "maxItems": 500,
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "require": {
                  "type": "object",
                  "propertyNames": {
                    "type": "string"
                  },
                  "additionalProperties": {
                    "anyOf": [
                      {
                        "description": "Empty cell",
                        "type": "null"
                      },
                      {
                        "description": "Text value. For dates use ISO 8601: \"2024-01-15\" or \"2024-01-15T10:30:00Z\"",
                        "type": "string"
                      },
                      {
                        "description": "Numeric value. For Ref columns, use row ID directly",
                        "type": "number"
                      },
                      {
                        "description": "True or false",
                        "type": "boolean"
                      },
                      {
                        "description": "List of values for ChoiceList or RefList columns",
                        "type": "array",
                        "items": {
                          "anyOf": [
                            {
                              "type": "string"
                            },
                            {
                              "type": "number"
                            },
                            {
                              "type": "boolean"
                            }
                          ]
                        }
                      }
                    ]
                  }
                },
                "fields": {
                  "type": "object",
                  "propertyNames": {
                    "type": "string"
                  },
                  "additionalProperties": {
                    "anyOf": [
                      {
                        "description": "Empty cell",
                        "type": "null"
                      },
                      {
                        "description": "Text value. For dates use ISO 8601: \"2024-01-15\" or \"2024-01-15T10:30:00Z\"",
                        "type": "string"
                      },
                      {
                        "description": "Numeric value. For Ref columns, use row ID directly",
                        "type": "number"
                      },
                      {
                        "description": "True or false",
                        "type": "boolean"
                      },
                      {
                        "description": "List of values for ChoiceList or RefList columns",
                        "type": "array",
                        "items": {
                          "anyOf": [
                            {
                              "type": "string"
                            },
                            {
                              "type": "number"
                            },
                            {
                              "type": "boolean"
                            }
                          ]
                        }
                      }
                    ]
                  }
                }
              }
            }
          },
          "onMany": {
            "description": "Strategy when multiple matches found: \"first\", \"none\", or \"all\"",
            "default": "first",
            "type": "string",
            "enum": [
              "first",
              "none",
              "all"
            ]
          },
          "allowEmptyRequire": {
            "description": "Allow upsert with no require fields (adds all as new records)",
            "default": false,
            "type": "boolean"
          },
          "add": {
            "description": "Allow adding new records if no match",
            "default": true,
            "type": "boolean"
          },
          "update": {
            "description": "Allow updating existing records",
            "default": true,
            "type": "boolean"
          },
          "response_format": {
            "description": "Output format: \"json\" for structured data, \"markdown\" for human-readable text",
            "default": "markdown",
            "type": "string",
            "enum": [
              "json",
              "markdown"
            ]
          }
        },
        "required": [
          "docId",
          "tableId",
          "records"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "const": true
          },
          "document_id": {
            "description": "Document ID",
            "type": "string"
          },
          "table_id": {
            "description": "Table ID",
            "type": "string"
          },
          "records_processed": {
            "description": "Total records processed",
            "type": "number"
          },
          "record_ids": {
            "description": "IDs of all affected rows",
            "type": "array",
            "items": {
              "type": "number"
            }
          },
          "message": {
            "description": "Success message",
            "type": "string"
          },
          "note": {
            "description": "Additional notes",
            "type": "string"
          }
        },
        "required": [
          "success",
          "document_id",
          "table_id",
          "records_processed",
          "record_ids"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "annotations": {
        "readOnlyHint": false,
        "destructiveHint": false,
        "idempotentHint": true,
        "openWorldHint": true
      },
      "execution": {
        "taskSupport": "forbidden"
      }
    },
    {
      "name": "grist_delete_records",
      "title": "Delete Grist Records",
      "description": "Permanently delete records by row ID or filters",
      "inputSchema": {
        "type": "object",
        "properties": {
          "docId": {
            "description": "Document ID from grist_get_documents. Examples: \"aKt7TZe8YGLp3ak8bDL8TZ\", \"qBbArddFDSrKd2jpv3uZTj\", \"xYz9123AbcDef456Ghi78J\"",
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "pattern": "^[1-9A-HJ-NP-Za-km-z]{22}$"
          },
          "tableId": {
            "description": "Table name from grist_get_tables. Examples: \"Contacts\", \"Sales_Data\", \"Projects\", \"Inventory\", \"Customers\"",
            "type": "string",
            "minLength": 1,
            "maxLength": 64,
            "pattern": "^[A-Z_][A-Za-z0-9_]*$"
          },
          "rowIds": {
            "description": "Array of row IDs to delete. Either rowIds OR filters must be provided.",
            "minItems": 1,
            "maxItems": 500,
            "type": "array",
            "items": {
              "type": "integer",
              "exclusiveMinimum": 0,
              "maximum": 9007199254740991
            }
          },
          "filters": {
            "description": "Delete records matching these filters. Either rowIds OR filters must be provided. Example: {\"Status\": \"Cancelled\"}",
            "type": "object",
            "propertyNames": {
              "type": "string"
            },
            "additionalProperties": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "number"
                },
                {
                  "type": "boolean"
                },
                {
                  "type": "null"
                },
                {
                  "type": "array",
                  "items": {
                    "anyOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "number"
                      },
                      {
                        "type": "boolean"
                      },
                      {
                        "type": "null"
                      }
                    ]
                  }
                }
              ]
            }
          },
          "response_format": {
            "description": "Output format: \"json\" for structured data, \"markdown\" for human-readable text",
            "default": "markdown",
            "type": "string",
            "enum": [
              "json",
              "markdown"
            ]
          }
        },
        "required": [
          "docId",
          "tableId"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "const": true
          },
          "document_id": {
            "description": "Document ID",
            "type": "string"
          },
          "table_id": {
            "description": "Table ID",
            "type": "string"
          },
          "records_deleted": {
            "description": "Number of records deleted",
            "type": "number"
          },
          "message": {
            "description": "Success message",
            "type": "string"
          },
          "warning": {
            "description": "Warning message",
            "type": "string"
          }
        },
        "required": [
          "success",
          "document_id",
          "table_id",
          "records_deleted"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "annotations": {
        "readOnlyHint": false,
        "destructiveHint": true,
        "idempotentHint": true,
        "openWorldHint": true
      },
      "execution": {
        "taskSupport": "forbidden"
      }
    },
    {
      "name": "grist_create_table",
      "title": "Create Grist Table",
      "description": "Create a new table with column definitions",
      "inputSchema": {
        "type": "object",
        "properties": {
          "docId": {
            "description": "Document ID from grist_get_documents. Examples: \"aKt7TZe8YGLp3ak8bDL8TZ\", \"qBbArddFDSrKd2jpv3uZTj\", \"xYz9123AbcDef456Ghi78J\"",
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "pattern": "^[1-9A-HJ-NP-Za-km-z]{22}$"
          },
          "tableName": {
            "description": "Name for the new table. Use alphanumeric characters and underscores. Example: \"Contacts\", \"Sales_Data\"",
            "type": "string",
            "minLength": 1,
            "maxLength": 100
          },
          "columns": {
            "description": "Array of column definitions to create with the table. Can be empty to create table with default columns",
            "minItems": 0,
            "maxItems": 100,
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "colId": {
                  "description": "Column identifier (e.g., \"Email\", \"Phone_Number\"). Use alphanumeric and underscores",
                  "type": "string",
                  "minLength": 1,
                  "maxLength": 64,
                  "pattern": "^[A-Za-z_][A-Za-z0-9_]*$"
                },
                "type": {
                  "description": "Column type: Text, Numeric, Int, Bool, Date, DateTime, Choice, ChoiceList, Attachments, Ref:TableName, RefList:TableName",
                  "anyOf": [
                    {
                      "type": "string",
                      "enum": [
                        "Text",
                        "Numeric",
                        "Int",
                        "Bool",
                        "Date",
                        "DateTime",
                        "Choice",
                        "ChoiceList",
                        "Attachments"
                      ]
                    },
                    {
                      "type": "string",
                      "pattern": "^Ref(List)?:[A-Za-z_][A-Za-z0-9_]*$"
                    }
                  ]
                },
                "label": {
                  "description": "Human-readable column label. If omitted, uses colId",
                  "type": "string"
                },
                "isFormula": {
                  "description": "Set to true if this is a formula column. Defaults to false (data column)",
                  "default": false,
                  "type": "boolean"
                },
                "formula": {
                  "description": "Formula code (Python) if isFormula is true. Example: \"$Price * $Quantity\"",
                  "type": "string"
                },
                "widgetOptions": {
                  "description": "Type-specific options. Ex: {\"numMode\":\"currency\",\"currency\":\"USD\"} for Numeric, {\"choices\":[\"A\",\"B\"]} for Choice",
                  "anyOf": [
                    {
                      "type": "string"
                    },
                    {
                      "anyOf": [
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "widget": {
                              "description": "Widget type for display",
                              "type": "string",
                              "enum": [
                                "TextBox",
                                "Markdown",
                                "HyperLink"
                              ]
                            },
                            "alignment": {
                              "description": "Text alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "wrap": {
                              "description": "Enable text wrapping",
                              "type": "boolean"
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "widget": {
                              "description": "Widget type for display",
                              "type": "string",
                              "enum": [
                                "Spinner"
                              ]
                            },
                            "numMode": {
                              "description": "Number display mode (currency, decimal, percent, scientific)",
                              "anyOf": [
                                {
                                  "type": "string",
                                  "enum": [
                                    "currency",
                                    "decimal",
                                    "percent",
                                    "scientific",
                                    "text"
                                  ]
                                },
                                {
                                  "type": "null"
                                }
                              ]
                            },
                            "currency": {
                              "description": "ISO 4217 currency code (e.g., \"USD\", \"EUR\", \"GBP\" - case-insensitive)",
                              "type": "string",
                              "minLength": 3,
                              "maxLength": 3
                            },
                            "numSign": {
                              "description": "Number sign display (null for minus, \"parens\" for parentheses)",
                              "anyOf": [
                                {
                                  "type": "string",
                                  "enum": [
                                    "parens"
                                  ]
                                },
                                {
                                  "type": "null"
                                }
                              ]
                            },
                            "decimals": {
                              "description": "Minimum number of decimal places to display (0-20)",
                              "type": "integer",
                              "minimum": 0,
                              "maximum": 20
                            },
                            "maxDecimals": {
                              "description": "Maximum number of decimal places to display (0-20)",
                              "type": "integer",
                              "minimum": 0,
                              "maximum": 20
                            },
                            "alignment": {
                              "description": "Number alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "widget": {
                              "description": "Widget type for boolean display (CheckBox or Switch)",
                              "type": "string",
                              "enum": [
                                "CheckBox",
                                "Switch"
                              ]
                            },
                            "alignment": {
                              "description": "Widget alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "dateFormat": {
                              "description": "Date format string (e.g., \"YYYY-MM-DD\", \"MMM D, YYYY\") - max 100 chars",
                              "type": "string",
                              "maxLength": 100
                            },
                            "isCustomDateFormat": {
                              "description": "Whether the date format is custom",
                              "type": "boolean"
                            },
                            "alignment": {
                              "description": "Date alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "dateFormat": {
                              "description": "Date format string - max 100 chars",
                              "type": "string",
                              "maxLength": 100
                            },
                            "isCustomDateFormat": {
                              "description": "Whether the date format is custom",
                              "type": "boolean"
                            },
                            "timeFormat": {
                              "description": "Time format string (e.g., \"HH:mm:ss\", \"h:mm A\") - max 100 chars",
                              "type": "string",
                              "maxLength": 100
                            },
                            "isCustomTimeFormat": {
                              "description": "Whether the time format is custom",
                              "type": "boolean"
                            },
                            "alignment": {
                              "description": "DateTime alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "choices": {
                              "description": "Available choices for the column (max 1000 choices, each max 255 chars)",
                              "maxItems": 1000,
                              "type": "array",
                              "items": {
                                "type": "string",
                                "minLength": 1,
                                "maxLength": 255
                              }
                            },
                            "choiceOptions": {
                              "description": "Style configuration for individual choices",
                              "type": "object",
                              "propertyNames": {
                                "type": "string"
                              },
                              "additionalProperties": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "alignment": {
                              "description": "Choice alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "choices": {
                              "description": "Available choices for the column (max 1000 choices, each max 255 chars)",
                              "maxItems": 1000,
                              "type": "array",
                              "items": {
                                "type": "string",
                                "minLength": 1,
                                "maxLength": 255
                              }
                            },
                            "choiceOptions": {
                              "description": "Style configuration for individual choices",
                              "type": "object",
                              "propertyNames": {
                                "type": "string"
                              },
                              "additionalProperties": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "alignment": {
                              "description": "Choice alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "alignment": {
                              "description": "Reference display alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "visibleCol": {
                              "description": "Column name or numeric ID to display (extracted during processing)",
                              "anyOf": [
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "number"
                                }
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "alignment": {
                              "description": "Reference display alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "visibleCol": {
                              "description": "Column name or numeric ID to display (extracted during processing)",
                              "anyOf": [
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "number"
                                }
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "height": {
                              "description": "Attachment display height in pixels (1-5000)",
                              "type": "integer",
                              "minimum": 1,
                              "maximum": 5000
                            },
                            "alignment": {
                              "description": "Attachment alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        }
                      ]
                    }
                  ]
                },
                "visibleCol": {
                  "description": "Display column for Ref/RefList. String name or numeric ID. Ex: \"Email\" or 456",
                  "anyOf": [
                    {
                      "type": "string"
                    },
                    {
                      "type": "number"
                    }
                  ]
                }
              },
              "required": [
                "colId",
                "type"
              ],
              "additionalProperties": false
            }
          },
          "response_format": {
            "description": "Output format: \"json\" for structured data, \"markdown\" for human-readable text",
            "default": "markdown",
            "type": "string",
            "enum": [
              "json",
              "markdown"
            ]
          }
        },
        "required": [
          "docId",
          "tableName",
          "columns"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "const": true
          },
          "document_id": {
            "description": "Document ID",
            "type": "string"
          },
          "table_id": {
            "description": "Created table ID",
            "type": "string"
          },
          "table_name": {
            "description": "Table display name",
            "type": "string"
          },
          "columns_created": {
            "description": "Number of columns created",
            "type": "number"
          },
          "message": {
            "description": "Success message",
            "type": "string"
          },
          "url": {
            "description": "URL to the new table",
            "type": "string"
          },
          "warnings": {
            "description": "Validation warnings",
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "column": {
                  "description": "Column name",
                  "type": "string"
                },
                "issue": {
                  "description": "Issue description",
                  "type": "string"
                },
                "suggestion": {
                  "description": "Suggested fix",
                  "type": "string"
                }
              },
              "required": [
                "column",
                "issue",
                "suggestion"
              ],
              "additionalProperties": false
            }
          }
        },
        "required": [
          "success",
          "document_id",
          "table_id",
          "table_name",
          "columns_created"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "annotations": {
        "readOnlyHint": false,
        "destructiveHint": false,
        "idempotentHint": false,
        "openWorldHint": true
      },
      "execution": {
        "taskSupport": "forbidden"
      }
    },
    {
      "name": "grist_rename_table",
      "title": "Rename Grist Table",
      "description": "Rename a table",
      "inputSchema": {
        "type": "object",
        "properties": {
          "docId": {
            "description": "Document ID from grist_get_documents. Examples: \"aKt7TZe8YGLp3ak8bDL8TZ\", \"qBbArddFDSrKd2jpv3uZTj\", \"xYz9123AbcDef456Ghi78J\"",
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "pattern": "^[1-9A-HJ-NP-Za-km-z]{22}$"
          },
          "tableId": {
            "description": "Table name from grist_get_tables. Examples: \"Contacts\", \"Sales_Data\", \"Projects\", \"Inventory\", \"Customers\"",
            "type": "string",
            "minLength": 1,
            "maxLength": 64,
            "pattern": "^[A-Z_][A-Za-z0-9_]*$"
          },
          "newTableId": {
            "description": "New table name. Must be unique within the document",
            "type": "string",
            "minLength": 1,
            "maxLength": 100
          },
          "response_format": {
            "description": "Output format: \"json\" for structured data, \"markdown\" for human-readable text",
            "default": "markdown",
            "type": "string",
            "enum": [
              "json",
              "markdown"
            ]
          }
        },
        "required": [
          "docId",
          "tableId",
          "newTableId"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "const": true
          },
          "document_id": {
            "description": "Document ID",
            "type": "string"
          },
          "old_table_id": {
            "description": "Previous table ID",
            "type": "string"
          },
          "new_table_id": {
            "description": "New table ID",
            "type": "string"
          },
          "message": {
            "description": "Success message",
            "type": "string"
          },
          "note": {
            "description": "Additional notes",
            "type": "string"
          }
        },
        "required": [
          "success",
          "document_id",
          "old_table_id",
          "new_table_id"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "annotations": {
        "readOnlyHint": false,
        "destructiveHint": false,
        "idempotentHint": true,
        "openWorldHint": true
      },
      "execution": {
        "taskSupport": "forbidden"
      }
    },
    {
      "name": "grist_delete_table",
      "title": "Delete Grist Table",
      "description": "Permanently delete a table and all its data",
      "inputSchema": {
        "type": "object",
        "properties": {
          "docId": {
            "description": "Document ID from grist_get_documents. Examples: \"aKt7TZe8YGLp3ak8bDL8TZ\", \"qBbArddFDSrKd2jpv3uZTj\", \"xYz9123AbcDef456Ghi78J\"",
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "pattern": "^[1-9A-HJ-NP-Za-km-z]{22}$"
          },
          "tableId": {
            "description": "Table name from grist_get_tables. Examples: \"Contacts\", \"Sales_Data\", \"Projects\", \"Inventory\", \"Customers\"",
            "type": "string",
            "minLength": 1,
            "maxLength": 64,
            "pattern": "^[A-Z_][A-Za-z0-9_]*$"
          },
          "response_format": {
            "description": "Output format: \"json\" for structured data, \"markdown\" for human-readable text",
            "default": "markdown",
            "type": "string",
            "enum": [
              "json",
              "markdown"
            ]
          }
        },
        "required": [
          "docId",
          "tableId"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "const": true
          },
          "document_id": {
            "description": "Document ID",
            "type": "string"
          },
          "table_id": {
            "description": "Deleted table ID",
            "type": "string"
          },
          "message": {
            "description": "Success message",
            "type": "string"
          },
          "warning": {
            "description": "Warning message",
            "type": "string"
          },
          "note": {
            "description": "Additional notes",
            "type": "string"
          }
        },
        "required": [
          "success",
          "document_id",
          "table_id"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "annotations": {
        "readOnlyHint": false,
        "destructiveHint": true,
        "idempotentHint": true,
        "openWorldHint": true
      },
      "execution": {
        "taskSupport": "forbidden"
      }
    },
    {
      "name": "grist_create_summary_table",
      "title": "Create Summary Table",
      "description": "Create an aggregated summary table from a source table",
      "inputSchema": {
        "type": "object",
        "properties": {
          "docId": {
            "description": "Document ID from grist_get_documents. Examples: \"aKt7TZe8YGLp3ak8bDL8TZ\", \"qBbArddFDSrKd2jpv3uZTj\", \"xYz9123AbcDef456Ghi78J\"",
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "pattern": "^[1-9A-HJ-NP-Za-km-z]{22}$"
          },
          "sourceTable": {
            "description": "Source table to create summary from. Example: \"Investments\", \"Sales\", \"Customers\"",
            "type": "string",
            "minLength": 1,
            "maxLength": 64,
            "pattern": "^[A-Z_][A-Za-z0-9_]*$"
          },
          "groupByColumns": {
            "description": "Columns to group by (1-10 columns). Example: [\"category\", \"year\"] creates summary grouped by category and year",
            "minItems": 1,
            "maxItems": 10,
            "type": "array",
            "items": {
              "type": "string",
              "minLength": 1
            }
          },
          "keepPage": {
            "description": "Keep the auto-created page visible in Grist UI. Default: false (summary table in Raw Data only). Set true to create a visible page named \"Summary: {table} by {columns}\"",
            "default": false,
            "type": "boolean"
          },
          "response_format": {
            "default": "markdown",
            "description": "Output format: \"json\" for structured data, \"markdown\" for human-readable text",
            "type": "string",
            "enum": [
              "json",
              "markdown"
            ]
          }
        },
        "required": [
          "docId",
          "sourceTable",
          "groupByColumns"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "const": true
          },
          "summary_table_id": {
            "description": "Created summary table ID",
            "type": "string"
          },
          "source_table": {
            "description": "Source table ID",
            "type": "string"
          },
          "group_by_columns": {
            "description": "Columns used for grouping",
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "columns": {
            "description": "All columns in summary table",
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "description": {
            "description": "Description of summary table",
            "type": "string"
          }
        },
        "required": [
          "success",
          "summary_table_id",
          "source_table",
          "group_by_columns",
          "columns",
          "description"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "annotations": {
        "readOnlyHint": false,
        "destructiveHint": false,
        "idempotentHint": false,
        "openWorldHint": true
      },
      "execution": {
        "taskSupport": "forbidden"
      }
    },
    {
      "name": "grist_manage_columns",
      "title": "Manage Grist Columns",
      "description": "Add, modify, delete, or rename columns",
      "inputSchema": {
        "type": "object",
        "properties": {
          "docId": {
            "description": "Document ID from grist_get_documents. Examples: \"aKt7TZe8YGLp3ak8bDL8TZ\", \"qBbArddFDSrKd2jpv3uZTj\", \"xYz9123AbcDef456Ghi78J\"",
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "pattern": "^[1-9A-HJ-NP-Za-km-z]{22}$"
          },
          "tableId": {
            "description": "Table name from grist_get_tables. Examples: \"Contacts\", \"Sales_Data\", \"Projects\", \"Inventory\", \"Customers\"",
            "type": "string",
            "minLength": 1,
            "maxLength": 64,
            "pattern": "^[A-Z_][A-Za-z0-9_]*$"
          },
          "operations": {
            "description": "Array of column operations to perform atomically (max 50). Operations execute in order",
            "minItems": 1,
            "maxItems": 50,
            "type": "array",
            "items": {
              "oneOf": [
                {
                  "type": "object",
                  "properties": {
                    "action": {
                      "type": "string",
                      "const": "add"
                    },
                    "colId": {
                      "description": "Column identifier. Use alphanumeric and underscores. Example: \"Email\", \"Phone_Number\"",
                      "type": "string",
                      "minLength": 1
                    },
                    "type": {
                      "description": "Column type: Text, Numeric, Int, Bool, Date, DateTime, Choice, ChoiceList, Attachments, Ref:TableName, RefList:TableName",
                      "anyOf": [
                        {
                          "type": "string",
                          "enum": [
                            "Text",
                            "Numeric",
                            "Int",
                            "Bool",
                            "Date",
                            "DateTime",
                            "Choice",
                            "ChoiceList",
                            "Attachments"
                          ]
                        },
                        {
                          "type": "string",
                          "pattern": "^Ref(List)?:[A-Za-z_][A-Za-z0-9_]*$"
                        }
                      ]
                    },
                    "label": {
                      "description": "Human-readable label. If omitted, uses colId",
                      "type": "string"
                    },
                    "formula": {
                      "description": "Formula code (Python) if this is a formula column. Example: \"$Price * $Quantity\"",
                      "type": "string"
                    },
                    "isFormula": {
                      "description": "Set to true if this is a formula column. Defaults to false (data column)",
                      "default": false,
                      "type": "boolean"
                    },
                    "widgetOptions": {
                      "description": "Widget options object validated by column type. Examples: {\"numMode\": \"currency\", \"currency\": \"USD\"} for Numeric, {\"choices\": [\"Red\", \"Blue\"]} for Choice, {\"dateFormat\": \"YYYY-MM-DD\"} for Date. Must match the column type - validation enforced.",
                      "anyOf": [
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "widget": {
                              "description": "Widget type for display",
                              "type": "string",
                              "enum": [
                                "TextBox",
                                "Markdown",
                                "HyperLink"
                              ]
                            },
                            "alignment": {
                              "description": "Text alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "wrap": {
                              "description": "Enable text wrapping",
                              "type": "boolean"
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "widget": {
                              "description": "Widget type for display",
                              "type": "string",
                              "enum": [
                                "Spinner"
                              ]
                            },
                            "numMode": {
                              "description": "Number display mode (currency, decimal, percent, scientific)",
                              "anyOf": [
                                {
                                  "type": "string",
                                  "enum": [
                                    "currency",
                                    "decimal",
                                    "percent",
                                    "scientific",
                                    "text"
                                  ]
                                },
                                {
                                  "type": "null"
                                }
                              ]
                            },
                            "currency": {
                              "description": "ISO 4217 currency code (e.g., \"USD\", \"EUR\", \"GBP\" - case-insensitive)",
                              "type": "string",
                              "minLength": 3,
                              "maxLength": 3
                            },
                            "numSign": {
                              "description": "Number sign display (null for minus, \"parens\" for parentheses)",
                              "anyOf": [
                                {
                                  "type": "string",
                                  "enum": [
                                    "parens"
                                  ]
                                },
                                {
                                  "type": "null"
                                }
                              ]
                            },
                            "decimals": {
                              "description": "Minimum number of decimal places to display (0-20)",
                              "type": "integer",
                              "minimum": 0,
                              "maximum": 20
                            },
                            "maxDecimals": {
                              "description": "Maximum number of decimal places to display (0-20)",
                              "type": "integer",
                              "minimum": 0,
                              "maximum": 20
                            },
                            "alignment": {
                              "description": "Number alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "widget": {
                              "description": "Widget type for boolean display (CheckBox or Switch)",
                              "type": "string",
                              "enum": [
                                "CheckBox",
                                "Switch"
                              ]
                            },
                            "alignment": {
                              "description": "Widget alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "dateFormat": {
                              "description": "Date format string (e.g., \"YYYY-MM-DD\", \"MMM D, YYYY\") - max 100 chars",
                              "type": "string",
                              "maxLength": 100
                            },
                            "isCustomDateFormat": {
                              "description": "Whether the date format is custom",
                              "type": "boolean"
                            },
                            "alignment": {
                              "description": "Date alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "dateFormat": {
                              "description": "Date format string - max 100 chars",
                              "type": "string",
                              "maxLength": 100
                            },
                            "isCustomDateFormat": {
                              "description": "Whether the date format is custom",
                              "type": "boolean"
                            },
                            "timeFormat": {
                              "description": "Time format string (e.g., \"HH:mm:ss\", \"h:mm A\") - max 100 chars",
                              "type": "string",
                              "maxLength": 100
                            },
                            "isCustomTimeFormat": {
                              "description": "Whether the time format is custom",
                              "type": "boolean"
                            },
                            "alignment": {
                              "description": "DateTime alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "choices": {
                              "description": "Available choices for the column (max 1000 choices, each max 255 chars)",
                              "maxItems": 1000,
                              "type": "array",
                              "items": {
                                "type": "string",
                                "minLength": 1,
                                "maxLength": 255
                              }
                            },
                            "choiceOptions": {
                              "description": "Style configuration for individual choices",
                              "type": "object",
                              "propertyNames": {
                                "type": "string"
                              },
                              "additionalProperties": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "alignment": {
                              "description": "Choice alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "choices": {
                              "description": "Available choices for the column (max 1000 choices, each max 255 chars)",
                              "maxItems": 1000,
                              "type": "array",
                              "items": {
                                "type": "string",
                                "minLength": 1,
                                "maxLength": 255
                              }
                            },
                            "choiceOptions": {
                              "description": "Style configuration for individual choices",
                              "type": "object",
                              "propertyNames": {
                                "type": "string"
                              },
                              "additionalProperties": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "alignment": {
                              "description": "Choice alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "alignment": {
                              "description": "Reference display alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "visibleCol": {
                              "description": "Column name or numeric ID to display (extracted during processing)",
                              "anyOf": [
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "number"
                                }
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "alignment": {
                              "description": "Reference display alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "visibleCol": {
                              "description": "Column name or numeric ID to display (extracted during processing)",
                              "anyOf": [
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "number"
                                }
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "height": {
                              "description": "Attachment display height in pixels (1-5000)",
                              "type": "integer",
                              "minimum": 1,
                              "maximum": 5000
                            },
                            "alignment": {
                              "description": "Attachment alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        }
                      ]
                    },
                    "visibleCol": {
                      "description": "Which column from referenced table to display (Ref/RefList only). String column name (e.g., \"Email\") auto-resolves to numeric ID. Numeric ID (e.g., 456) used directly.",
                      "anyOf": [
                        {
                          "type": "string"
                        },
                        {
                          "type": "number"
                        }
                      ]
                    }
                  },
                  "required": [
                    "action",
                    "colId",
                    "type"
                  ],
                  "additionalProperties": false
                },
                {
                  "type": "object",
                  "properties": {
                    "action": {
                      "type": "string",
                      "const": "modify"
                    },
                    "colId": {
                      "description": "Existing column identifier to modify",
                      "type": "string",
                      "minLength": 1
                    },
                    "type": {
                      "description": "Column type: Text, Numeric, Int, Bool, Date, DateTime, Choice, ChoiceList, Attachments, Ref:TableName, RefList:TableName",
                      "anyOf": [
                        {
                          "type": "string",
                          "enum": [
                            "Text",
                            "Numeric",
                            "Int",
                            "Bool",
                            "Date",
                            "DateTime",
                            "Choice",
                            "ChoiceList",
                            "Attachments"
                          ]
                        },
                        {
                          "type": "string",
                          "pattern": "^Ref(List)?:[A-Za-z_][A-Za-z0-9_]*$"
                        }
                      ]
                    },
                    "label": {
                      "type": "string"
                    },
                    "formula": {
                      "type": "string"
                    },
                    "isFormula": {
                      "description": "Set to true if this is a formula column. Defaults to false (data column)",
                      "default": false,
                      "type": "boolean"
                    },
                    "widgetOptions": {
                      "description": "Widget options object validated by column type. IMPORTANT: When updating widgetOptions, you MUST also include the \"type\" field to enable proper validation. Example: {action: \"modify\", colId: \"Price\", type: \"Numeric\", widgetOptions: {\"numMode\": \"currency\", \"currency\": \"USD\"}}",
                      "anyOf": [
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "widget": {
                              "description": "Widget type for display",
                              "type": "string",
                              "enum": [
                                "TextBox",
                                "Markdown",
                                "HyperLink"
                              ]
                            },
                            "alignment": {
                              "description": "Text alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "wrap": {
                              "description": "Enable text wrapping",
                              "type": "boolean"
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "widget": {
                              "description": "Widget type for display",
                              "type": "string",
                              "enum": [
                                "Spinner"
                              ]
                            },
                            "numMode": {
                              "description": "Number display mode (currency, decimal, percent, scientific)",
                              "anyOf": [
                                {
                                  "type": "string",
                                  "enum": [
                                    "currency",
                                    "decimal",
                                    "percent",
                                    "scientific",
                                    "text"
                                  ]
                                },
                                {
                                  "type": "null"
                                }
                              ]
                            },
                            "currency": {
                              "description": "ISO 4217 currency code (e.g., \"USD\", \"EUR\", \"GBP\" - case-insensitive)",
                              "type": "string",
                              "minLength": 3,
                              "maxLength": 3
                            },
                            "numSign": {
                              "description": "Number sign display (null for minus, \"parens\" for parentheses)",
                              "anyOf": [
                                {
                                  "type": "string",
                                  "enum": [
                                    "parens"
                                  ]
                                },
                                {
                                  "type": "null"
                                }
                              ]
                            },
                            "decimals": {
                              "description": "Minimum number of decimal places to display (0-20)",
                              "type": "integer",
                              "minimum": 0,
                              "maximum": 20
                            },
                            "maxDecimals": {
                              "description": "Maximum number of decimal places to display (0-20)",
                              "type": "integer",
                              "minimum": 0,
                              "maximum": 20
                            },
                            "alignment": {
                              "description": "Number alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "widget": {
                              "description": "Widget type for boolean display (CheckBox or Switch)",
                              "type": "string",
                              "enum": [
                                "CheckBox",
                                "Switch"
                              ]
                            },
                            "alignment": {
                              "description": "Widget alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "dateFormat": {
                              "description": "Date format string (e.g., \"YYYY-MM-DD\", \"MMM D, YYYY\") - max 100 chars",
                              "type": "string",
                              "maxLength": 100
                            },
                            "isCustomDateFormat": {
                              "description": "Whether the date format is custom",
                              "type": "boolean"
                            },
                            "alignment": {
                              "description": "Date alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "dateFormat": {
                              "description": "Date format string - max 100 chars",
                              "type": "string",
                              "maxLength": 100
                            },
                            "isCustomDateFormat": {
                              "description": "Whether the date format is custom",
                              "type": "boolean"
                            },
                            "timeFormat": {
                              "description": "Time format string (e.g., \"HH:mm:ss\", \"h:mm A\") - max 100 chars",
                              "type": "string",
                              "maxLength": 100
                            },
                            "isCustomTimeFormat": {
                              "description": "Whether the time format is custom",
                              "type": "boolean"
                            },
                            "alignment": {
                              "description": "DateTime alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "choices": {
                              "description": "Available choices for the column (max 1000 choices, each max 255 chars)",
                              "maxItems": 1000,
                              "type": "array",
                              "items": {
                                "type": "string",
                                "minLength": 1,
                                "maxLength": 255
                              }
                            },
                            "choiceOptions": {
                              "description": "Style configuration for individual choices",
                              "type": "object",
                              "propertyNames": {
                                "type": "string"
                              },
                              "additionalProperties": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "alignment": {
                              "description": "Choice alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "choices": {
                              "description": "Available choices for the column (max 1000 choices, each max 255 chars)",
                              "maxItems": 1000,
                              "type": "array",
                              "items": {
                                "type": "string",
                                "minLength": 1,
                                "maxLength": 255
                              }
                            },
                            "choiceOptions": {
                              "description": "Style configuration for individual choices",
                              "type": "object",
                              "propertyNames": {
                                "type": "string"
                              },
                              "additionalProperties": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "alignment": {
                              "description": "Choice alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "alignment": {
                              "description": "Reference display alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "visibleCol": {
                              "description": "Column name or numeric ID to display (extracted during processing)",
                              "anyOf": [
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "number"
                                }
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "alignment": {
                              "description": "Reference display alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "visibleCol": {
                              "description": "Column name or numeric ID to display (extracted during processing)",
                              "anyOf": [
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "number"
                                }
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        },
                        {
                          "type": "object",
                          "properties": {
                            "textColor": {
                              "description": "Text color in hex format (e.g., \"#FF0000\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fillColor": {
                              "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "fontBold": {
                              "description": "Bold text formatting",
                              "type": "boolean"
                            },
                            "fontItalic": {
                              "description": "Italic text formatting",
                              "type": "boolean"
                            },
                            "fontUnderline": {
                              "description": "Underline text formatting",
                              "type": "boolean"
                            },
                            "fontStrikethrough": {
                              "description": "Strikethrough text formatting",
                              "type": "boolean"
                            },
                            "height": {
                              "description": "Attachment display height in pixels (1-5000)",
                              "type": "integer",
                              "minimum": 1,
                              "maximum": 5000
                            },
                            "alignment": {
                              "description": "Attachment alignment",
                              "type": "string",
                              "enum": [
                                "left",
                                "center",
                                "right"
                              ]
                            },
                            "rulesOptions": {
                              "description": "Conditional formatting styles (array index matches rules array)",
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "textColor": {
                                    "description": "Text color in hex format (e.g., \"#FF0000\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fillColor": {
                                    "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                                    "type": "string",
                                    "pattern": "^#[0-9A-Fa-f]{6}$"
                                  },
                                  "fontBold": {
                                    "description": "Bold text formatting",
                                    "type": "boolean"
                                  },
                                  "fontItalic": {
                                    "description": "Italic text formatting",
                                    "type": "boolean"
                                  },
                                  "fontUnderline": {
                                    "description": "Underline text formatting",
                                    "type": "boolean"
                                  },
                                  "fontStrikethrough": {
                                    "description": "Strikethrough text formatting",
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false
                              }
                            },
                            "headerTextColor": {
                              "description": "Header text color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFillColor": {
                              "description": "Header background color in hex format",
                              "type": "string",
                              "pattern": "^#[0-9A-Fa-f]{6}$"
                            },
                            "headerFontBold": {
                              "description": "Bold header text",
                              "type": "boolean"
                            },
                            "headerFontUnderline": {
                              "description": "Underline header text",
                              "type": "boolean"
                            },
                            "headerFontItalic": {
                              "description": "Italic header text",
                              "type": "boolean"
                            },
                            "headerFontStrikethrough": {
                              "description": "Strikethrough header text",
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false
                        }
                      ]
                    },
                    "visibleCol": {
                      "description": "Which column from referenced table to display (Ref/RefList only). String column name (e.g., \"Email\") auto-resolves to numeric ID. Numeric ID (e.g., 456) used directly.",
                      "anyOf": [
                        {
                          "type": "string"
                        },
                        {
                          "type": "number"
                        }
                      ]
                    },
                    "untieColIdFromLabel": {
                      "description": "Set to true to allow colId and label to be independent. By default, Grist auto-updates colId when label changes. Setting this to true prevents that behavior.",
                      "type": "boolean"
                    }
                  },
                  "required": [
                    "action",
                    "colId"
                  ],
                  "additionalProperties": false
                },
                {
                  "type": "object",
                  "properties": {
                    "action": {
                      "type": "string",
                      "const": "delete"
                    },
                    "colId": {
                      "description": "Column identifier to delete",
                      "type": "string",
                      "minLength": 1
                    }
                  },
                  "required": [
                    "action",
                    "colId"
                  ],
                  "additionalProperties": false
                },
                {
                  "type": "object",
                  "properties": {
                    "action": {
                      "type": "string",
                      "const": "rename"
                    },
                    "oldColId": {
                      "description": "Current column identifier",
                      "type": "string",
                      "minLength": 1
                    },
                    "newColId": {
                      "description": "New column identifier",
                      "type": "string",
                      "minLength": 1
                    }
                  },
                  "required": [
                    "action",
                    "oldColId",
                    "newColId"
                  ],
                  "additionalProperties": false
                }
              ]
            }
          },
          "response_format": {
            "description": "Output format: \"json\" for structured data, \"markdown\" for human-readable text",
            "default": "markdown",
            "type": "string",
            "enum": [
              "json",
              "markdown"
            ]
          }
        },
        "required": [
          "docId",
          "tableId",
          "operations"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "const": true
          },
          "document_id": {
            "description": "Document ID",
            "type": "string"
          },
          "table_id": {
            "description": "Table ID",
            "type": "string"
          },
          "operations_performed": {
            "description": "Number of operations completed",
            "type": "number"
          },
          "actions": {
            "description": "Description of each action performed",
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "summary": {
            "description": "Operation counts summary",
            "type": "object",
            "properties": {
              "added": {
                "description": "Number of columns added",
                "type": "number"
              },
              "modified": {
                "description": "Number of columns modified",
                "type": "number"
              },
              "deleted": {
                "description": "Number of columns deleted",
                "type": "number"
              },
              "renamed": {
                "description": "Number of columns renamed",
                "type": "number"
              }
            },
            "required": [
              "added",
              "modified",
              "deleted",
              "renamed"
            ],
            "additionalProperties": false
          },
          "message": {
            "description": "Success message",
            "type": "string"
          },
          "details": {
            "description": "Detailed operation results",
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "hint": {
            "description": "Usage hints",
            "type": "string"
          }
        },
        "required": [
          "success",
          "document_id",
          "table_id",
          "operations_performed",
          "actions"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "annotations": {
        "readOnlyHint": false,
        "destructiveHint": false,
        "idempotentHint": false,
        "openWorldHint": true
      },
      "execution": {
        "taskSupport": "forbidden"
      }
    },
    {
      "name": "grist_manage_conditional_rules",
      "title": "Manage Conditional Rules",
      "description": "Add, update, remove, or list conditional formatting rules",
      "inputSchema": {
        "type": "object",
        "properties": {
          "docId": {
            "description": "Document ID from grist_get_documents. Examples: \"aKt7TZe8YGLp3ak8bDL8TZ\", \"qBbArddFDSrKd2jpv3uZTj\", \"xYz9123AbcDef456Ghi78J\"",
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "pattern": "^[1-9A-HJ-NP-Za-km-z]{22}$"
          },
          "scope": {
            "description": "Scope of conditional formatting rules",
            "type": "string",
            "enum": [
              "row",
              "column",
              "field"
            ]
          },
          "tableId": {
            "description": "Table name from grist_get_tables. Examples: \"Contacts\", \"Sales_Data\", \"Projects\", \"Inventory\", \"Customers\"",
            "type": "string",
            "minLength": 1,
            "maxLength": 64,
            "pattern": "^[A-Z_][A-Za-z0-9_]*$"
          },
          "colId": {
            "description": "Required for column and field scopes",
            "type": "string",
            "minLength": 1,
            "maxLength": 64,
            "pattern": "^[A-Za-z_][A-Za-z0-9_]*$"
          },
          "sectionId": {
            "description": "Widget section ID (for field scope). Alternative to pageName+widgetTitle.",
            "type": "integer",
            "exclusiveMinimum": 0,
            "maximum": 9007199254740991
          },
          "pageName": {
            "description": "Page name (for field scope). Use with widgetTitle.",
            "type": "string",
            "minLength": 1
          },
          "widgetTitle": {
            "description": "Widget title (for field scope). Use with pageName.",
            "type": "string",
            "minLength": 1
          },
          "operation": {
            "oneOf": [
              {
                "type": "object",
                "properties": {
                  "action": {
                    "type": "string",
                    "const": "add"
                  },
                  "rule": {
                    "description": "Conditional rule to add. Will be appended to end of rules array (lowest priority).",
                    "type": "object",
                    "properties": {
                      "formula": {
                        "description": "Python formula returning boolean. Examples: \"$Price > 1000\", \"$Status == \\\"Active\\\"\", \"$DueDate < NOW()\"",
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 1000
                      },
                      "style": {
                        "type": "object",
                        "properties": {
                          "textColor": {
                            "description": "Text color in hex format (e.g., \"#FF0000\")",
                            "type": "string",
                            "pattern": "^#[0-9A-Fa-f]{6}$"
                          },
                          "fillColor": {
                            "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                            "type": "string",
                            "pattern": "^#[0-9A-Fa-f]{6}$"
                          },
                          "fontBold": {
                            "description": "Bold text formatting",
                            "type": "boolean"
                          },
                          "fontItalic": {
                            "description": "Italic text formatting",
                            "type": "boolean"
                          },
                          "fontUnderline": {
                            "description": "Underline text formatting",
                            "type": "boolean"
                          },
                          "fontStrikethrough": {
                            "description": "Strikethrough text formatting",
                            "type": "boolean"
                          }
                        },
                        "additionalProperties": false
                      }
                    },
                    "required": [
                      "formula",
                      "style"
                    ],
                    "additionalProperties": false
                  }
                },
                "required": [
                  "action",
                  "rule"
                ],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "action": {
                    "type": "string",
                    "const": "update"
                  },
                  "ruleIndex": {
                    "description": "Zero-based index of rule to update. Get current index from list operation.",
                    "type": "integer",
                    "minimum": 0,
                    "maximum": 9007199254740991
                  },
                  "rule": {
                    "description": "Updated rule definition (replaces existing rule).",
                    "type": "object",
                    "properties": {
                      "formula": {
                        "description": "Python formula returning boolean. Examples: \"$Price > 1000\", \"$Status == \\\"Active\\\"\", \"$DueDate < NOW()\"",
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 1000
                      },
                      "style": {
                        "type": "object",
                        "properties": {
                          "textColor": {
                            "description": "Text color in hex format (e.g., \"#FF0000\")",
                            "type": "string",
                            "pattern": "^#[0-9A-Fa-f]{6}$"
                          },
                          "fillColor": {
                            "description": "Background/fill color in hex format (e.g., \"#FFFF00\")",
                            "type": "string",
                            "pattern": "^#[0-9A-Fa-f]{6}$"
                          },
                          "fontBold": {
                            "description": "Bold text formatting",
                            "type": "boolean"
                          },
                          "fontItalic": {
                            "description": "Italic text formatting",
                            "type": "boolean"
                          },
                          "fontUnderline": {
                            "description": "Underline text formatting",
                            "type": "boolean"
                          },
                          "fontStrikethrough": {
                            "description": "Strikethrough text formatting",
                            "type": "boolean"
                          }
                        },
                        "additionalProperties": false
                      }
                    },
                    "required": [
                      "formula",
                      "style"
                    ],
                    "additionalProperties": false
                  }
                },
                "required": [
                  "action",
                  "ruleIndex",
                  "rule"
                ],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "action": {
                    "type": "string",
                    "const": "remove"
                  },
                  "ruleIndex": {
                    "description": "Zero-based index of rule to remove. Get current index from list operation.",
                    "type": "integer",
                    "minimum": 0,
                    "maximum": 9007199254740991
                  }
                },
                "required": [
                  "action",
                  "ruleIndex"
                ],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "action": {
                    "type": "string",
                    "const": "list"
                  }
                },
                "required": [
                  "action"
                ],
                "additionalProperties": false
              }
            ]
          },
          "response_format": {
            "description": "Output format: \"json\" for structured data, \"markdown\" for human-readable text",
            "default": "markdown",
            "type": "string",
            "enum": [
              "json",
              "markdown"
            ]
          }
        },
        "required": [
          "docId",
          "scope",
          "tableId",
          "operation"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "const": true
          },
          "document_id": {
            "description": "Document ID",
            "type": "string"
          },
          "table_id": {
            "description": "Table ID",
            "type": "string"
          },
          "scope": {
            "description": "Rule scope (row/column/field)",
            "type": "string"
          },
          "action": {
            "description": "Action performed",
            "type": "string"
          },
          "rules_count": {
            "description": "Number of rules after operation",
            "type": "number"
          },
          "rules": {
            "description": "List of rules (for list action)",
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "index": {
                  "description": "Rule index",
                  "type": "number"
                },
                "formula": {
                  "description": "Rule formula",
                  "type": "string"
                },
                "style": {
                  "description": "Rule style",
                  "type": "object",
                  "propertyNames": {
                    "type": "string"
                  },
                  "additionalProperties": {}
                }
              },
              "required": [
                "index",
                "formula",
                "style"
              ],
              "additionalProperties": false
            }
          }
        },
        "required": [
          "success",
          "document_id",
          "table_id",
          "scope",
          "action"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "annotations": {
        "readOnlyHint": false,
        "destructiveHint": false,
        "idempotentHint": false,
        "openWorldHint": true
      },
      "execution": {
        "taskSupport": "forbidden"
      }
    },
    {
      "name": "grist_create_document",
      "title": "Create Document",
      "description": "Create a new document or fork an existing one",
      "inputSchema": {
        "type": "object",
        "properties": {
          "name": {
            "description": "Name for the new document. Example: \"Customer CRM\", \"Q4 Sales Report\", \"Project Tracker\"",
            "type": "string",
            "minLength": 1,
            "maxLength": 200
          },
          "workspaceId": {
            "description": "Workspace ID from grist_get_workspaces. Examples: 123, 456, 789 (numeric)",
            "type": "integer",
            "exclusiveMinimum": 0,
            "maximum": 9007199254740991
          },
          "forkFromDocId": {
            "description": "Optional: Document ID to fork from. Creates a copy with same structure and data. Omit to create blank document",
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "pattern": "^[1-9A-HJ-NP-Za-km-z]{22}$"
          },
          "response_format": {
            "description": "Output format: \"json\" for structured data, \"markdown\" for human-readable text",
            "default": "markdown",
            "type": "string",
            "enum": [
              "json",
              "markdown"
            ]
          }
        },
        "required": [
          "name",
          "workspaceId"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "const": true
          },
          "document_id": {
            "description": "Created document ID",
            "type": "string"
          },
          "document_name": {
            "description": "Document name",
            "type": "string"
          },
          "workspace_id": {
            "description": "Workspace ID",
            "type": "number"
          },
          "url": {
            "description": "Document URL",
            "type": "string"
          },
          "forked_from": {
            "description": "Source document if forked",
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ]
          },
          "message": {
            "description": "Success message",
            "type": "string"
          },
          "next_steps": {
            "description": "Suggested next actions",
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        },
        "required": [
          "success",
          "document_id",
          "document_name",
          "workspace_id",
          "url"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "annotations": {
        "readOnlyHint": false,
        "destructiveHint": false,
        "idempotentHint": false,
        "openWorldHint": true
      },
      "execution": {
        "taskSupport": "forbidden"
      }
    },
    {
      "name": "grist_get_pages",
      "title": "Get Pages",
      "description": "List pages and widgets in a document",
      "inputSchema": {
        "type": "object",
        "properties": {
          "docId": {
            "description": "Document ID from grist_get_documents. Examples: \"aKt7TZe8YGLp3ak8bDL8TZ\", \"qBbArddFDSrKd2jpv3uZTj\", \"xYz9123AbcDef456Ghi78J\"",
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "pattern": "^[1-9A-HJ-NP-Za-km-z]{22}$"
          },
          "detail_level": {
            "description": "\"summary\": Page names, widget types, tables. \"detailed\": + linking info, chart configs, group-by columns",
            "default": "summary",
            "type": "string",
            "enum": [
              "summary",
              "detailed"
            ]
          },
          "limit": {
            "description": "Maximum number of pages to return (1-100, default: 50)",
            "default": 50,
            "type": "integer",
            "minimum": 1,
            "maximum": 100
          },
          "offset": {
            "description": "Starting position for pagination (default: 0)",
            "default": 0,
            "type": "integer",
            "minimum": 0,
            "maximum": 9007199254740991
          },
          "response_format": {
            "default": "markdown",
            "description": "Output format: \"json\" for structured data, \"markdown\" for human-readable text",
            "type": "string",
            "enum": [
              "json",
              "markdown"
            ]
          }
        },
        "required": [
          "docId"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "const": true
          },
          "doc_id": {
            "description": "Document ID",
            "type": "string"
          },
          "pages": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "page_id": {
                  "description": "Page ID",
                  "type": "number"
                },
                "page_name": {
                  "description": "Page name",
                  "type": "string"
                },
                "widgets": {
                  "description": "Widgets on this page",
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "widget_id": {
                        "description": "Widget section ID",
                        "type": "number"
                      },
                      "title": {
                        "description": "Widget title",
                        "type": "string"
                      },
                      "widget_type": {
                        "description": "Widget type (grid, card, card_list, chart, form, custom)",
                        "type": "string"
                      },
                      "table_id": {
                        "description": "Data source table",
                        "type": "string"
                      },
                      "table_ref": {
                        "description": "Table reference ID",
                        "type": "number"
                      },
                      "is_summary_table": {
                        "description": "Whether showing summary data",
                        "type": "boolean"
                      },
                      "summary_source_table": {
                        "description": "Source table for summary",
                        "type": "string"
                      },
                      "group_by_columns": {
                        "description": "Group-by columns for summary",
                        "type": "array",
                        "items": {
                          "type": "string"
                        }
                      },
                      "linked_to": {
                        "description": "Link configuration",
                        "type": "object",
                        "properties": {
                          "source_widget_id": {
                            "description": "Source widget section ID",
                            "type": "number"
                          },
                          "source_col_ref": {
                            "description": "Source column reference",
                            "type": "number"
                          },
                          "target_col_ref": {
                            "description": "Target column reference",
                            "type": "number"
                          }
                        },
                        "required": [
                          "source_widget_id",
                          "source_col_ref",
                          "target_col_ref"
                        ],
                        "additionalProperties": false
                      },
                      "chart_config": {
                        "description": "Chart configuration if applicable",
                        "type": "object",
                        "properties": {
                          "chart_type": {
                            "description": "Chart type",
                            "type": "string"
                          }
                        },
                        "required": [
                          "chart_type"
                        ],
                        "additionalProperties": false
                      }
                    },
                    "required": [
                      "widget_id",
                      "title",
                      "widget_type",
                      "table_id",
                      "table_ref",
                      "is_summary_table"
                    ],
                    "additionalProperties": false
                  }
                }
              },
              "required": [
                "page_id",
                "page_name",
                "widgets"
              ],
              "additionalProperties": false
            }
          },
          "raw_data_tables": {
            "description": "Tables in Raw Data section",
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "table_id": {
                  "description": "Table ID",
                  "type": "string"
                },
                "table_ref": {
                  "description": "Table reference ID",
                  "type": "number"
                },
                "is_summary_table": {
                  "description": "Whether this is a summary table",
                  "type": "boolean"
                },
                "summary_source_table": {
                  "description": "Source table for summary",
                  "type": "string"
                },
                "group_by_columns": {
                  "description": "Group-by columns",
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                },
                "referenced_on_pages": {
                  "description": "Page IDs referencing this table",
                  "type": "array",
                  "items": {
                    "type": "number"
                  }
                }
              },
              "required": [
                "table_id",
                "table_ref",
                "is_summary_table",
                "referenced_on_pages"
              ],
              "additionalProperties": false
            }
          },
          "summary": {
            "type": "object",
            "properties": {
              "total_pages": {
                "description": "Total page count",
                "type": "number"
              },
              "total_widgets": {
                "description": "Total widget count",
                "type": "number"
              },
              "total_tables": {
                "description": "Total table count",
                "type": "number"
              },
              "summary_tables": {
                "description": "Summary table count",
                "type": "number"
              }
            },
            "required": [
              "total_pages",
              "total_widgets",
              "total_tables",
              "summary_tables"
            ],
            "additionalProperties": false
          },
          "pagination": {
            "type": "object",
            "properties": {
              "total": {
                "description": "Total number of items available",
                "type": "number"
              },
              "offset": {
                "description": "Starting position of current page",
                "type": "number"
              },
              "limit": {
                "description": "Maximum items per page",
                "type": "number"
              },
              "has_more": {
                "description": "Whether more items are available",
                "type": "boolean"
              },
              "next_offset": {
                "description": "Offset for next page, null if no more",
                "anyOf": [
                  {
                    "type": "number"
                  },
                  {
                    "type": "null"
                  }
                ]
              }
            },
            "required": [
              "total",
              "offset",
              "limit",
              "has_more",
              "next_offset"
            ],
            "additionalProperties": false
          }
        },
        "required": [
          "success",
          "doc_id",
          "pages",
          "raw_data_tables",
          "summary",
          "pagination"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "annotations": {
        "readOnlyHint": true,
        "destructiveHint": false,
        "idempotentHint": true,
        "openWorldHint": true
      },
      "execution": {
        "taskSupport": "forbidden"
      }
    },
    {
      "name": "grist_build_page",
      "title": "Build Page",
      "description": "Create pages with widget patterns (master-detail, hierarchical, chart dashboard)",
      "inputSchema": {
        "type": "object",
        "properties": {
          "docId": {
            "description": "Document ID from grist_get_documents. Examples: \"aKt7TZe8YGLp3ak8bDL8TZ\", \"qBbArddFDSrKd2jpv3uZTj\", \"xYz9123AbcDef456Ghi78J\"",
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "pattern": "^[1-9A-HJ-NP-Za-km-z]{22}$"
          },
          "page_name": {
            "description": "Page name for navigation (e.g., \"Sales Dashboard\", \"Inventory View\")",
            "type": "string",
            "minLength": 1,
            "maxLength": 255
          },
          "config": {
            "oneOf": [
              {
                "type": "object",
                "properties": {
                  "pattern": {
                    "type": "string",
                    "const": "master_detail"
                  },
                  "master": {
                    "type": "object",
                    "properties": {
                      "table": {
                        "description": "Data table name for this widget",
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 64,
                        "pattern": "^[A-Z_][A-Za-z0-9_]*$"
                      },
                      "widget_type": {
                        "description": "Widget display type (grid, card, card_list, chart, form, custom)",
                        "default": "grid",
                        "type": "string",
                        "enum": [
                          "grid",
                          "card",
                          "card_list",
                          "chart",
                          "form",
                          "custom"
                        ]
                      },
                      "title": {
                        "description": "Widget title (defaults to table name)",
                        "type": "string"
                      },
                      "description": {
                        "description": "Widget description",
                        "type": "string"
                      },
                      "width": {
                        "description": "Master widget width percentage (10-90, default: 50)",
                        "default": 50,
                        "type": "integer",
                        "minimum": 10,
                        "maximum": 90
                      }
                    },
                    "required": [
                      "table"
                    ],
                    "additionalProperties": false
                  },
                  "detail": {
                    "type": "object",
                    "properties": {
                      "table": {
                        "description": "Data table name for this widget",
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 64,
                        "pattern": "^[A-Z_][A-Za-z0-9_]*$"
                      },
                      "widget_type": {
                        "description": "Widget display type (grid, card, card_list, chart, form, custom)",
                        "default": "grid",
                        "type": "string",
                        "enum": [
                          "grid",
                          "card",
                          "card_list",
                          "chart",
                          "form",
                          "custom"
                        ]
                      },
                      "title": {
                        "description": "Widget title (defaults to table name)",
                        "type": "string"
                      },
                      "description": {
                        "description": "Widget description",
                        "type": "string"
                      },
                      "link_field": {
                        "description": "Reference column in detail table linking to master table",
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "number"
                          }
                        ]
                      }
                    },
                    "required": [
                      "table",
                      "link_field"
                    ],
                    "additionalProperties": false
                  },
                  "split": {
                    "description": "Split direction",
                    "default": "horizontal",
                    "type": "string",
                    "enum": [
                      "horizontal",
                      "vertical"
                    ]
                  }
                },
                "required": [
                  "pattern",
                  "master",
                  "detail"
                ],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "pattern": {
                    "type": "string",
                    "const": "hierarchical"
                  },
                  "levels": {
                    "description": "Summary levels (2-5 levels, each with group_by columns)",
                    "minItems": 2,
                    "maxItems": 5,
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "table": {
                          "description": "Data table name for this widget",
                          "type": "string",
                          "minLength": 1,
                          "maxLength": 64,
                          "pattern": "^[A-Z_][A-Za-z0-9_]*$"
                        },
                        "widget_type": {
                          "description": "Widget display type (grid, card, card_list, chart, form, custom)",
                          "default": "grid",
                          "type": "string",
                          "enum": [
                            "grid",
                            "card",
                            "card_list",
                            "chart",
                            "form",
                            "custom"
                          ]
                        },
                        "title": {
                          "description": "Widget title (defaults to table name)",
                          "type": "string"
                        },
                        "description": {
                          "description": "Widget description",
                          "type": "string"
                        },
                        "group_by": {
                          "description": "Columns to group by for this summary level",
                          "minItems": 1,
                          "type": "array",
                          "items": {
                            "type": "string"
                          }
                        }
                      },
                      "required": [
                        "table",
                        "group_by"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                "required": [
                  "pattern",
                  "levels"
                ],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "pattern": {
                    "type": "string",
                    "const": "chart_dashboard"
                  },
                  "selector": {
                    "description": "Optional selector widget (table/card list)",
                    "type": "object",
                    "properties": {
                      "table": {
                        "description": "Data table name for this widget",
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 64,
                        "pattern": "^[A-Z_][A-Za-z0-9_]*$"
                      },
                      "widget_type": {
                        "description": "Widget display type (grid, card, card_list, chart, form, custom)",
                        "default": "grid",
                        "type": "string",
                        "enum": [
                          "grid",
                          "card",
                          "card_list",
                          "chart",
                          "form",
                          "custom"
                        ]
                      },
                      "title": {
                        "description": "Widget title (defaults to table name)",
                        "type": "string"
                      },
                      "description": {
                        "description": "Widget description",
                        "type": "string"
                      }
                    },
                    "required": [
                      "table"
                    ]
                  },
                  "charts": {
                    "description": "Chart widgets (1-6 charts)",
                    "minItems": 1,
                    "maxItems": 6,
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "table": {
                          "description": "Data table name for this widget",
                          "type": "string",
                          "minLength": 1,
                          "maxLength": 64,
                          "pattern": "^[A-Z_][A-Za-z0-9_]*$"
                        },
                        "widget_type": {
                          "type": "string",
                          "const": "chart"
                        },
                        "title": {
                          "description": "Widget title (defaults to table name)",
                          "type": "string"
                        },
                        "description": {
                          "description": "Widget description",
                          "type": "string"
                        },
                        "chart_type": {
                          "description": "Chart type",
                          "type": "string",
                          "enum": [
                            "bar",
                            "pie",
                            "donut",
                            "area",
                            "line",
                            "scatter",
                            "kaplan_meier"
                          ]
                        },
                        "x_axis": {
                          "description": "X-axis column name",
                          "type": "string"
                        },
                        "y_axis": {
                          "description": "Y-axis column names (series)",
                          "type": "array",
                          "items": {
                            "type": "string"
                          }
                        },
                        "chart_options": {
                          "description": "Chart display options (stored in options column as JSON)",
                          "type": "object",
                          "properties": {
                            "multiseries": {
                              "type": "boolean"
                            },
                            "lineConnectGaps": {
                              "type": "boolean"
                            },
                            "lineMarkers": {
                              "type": "boolean"
                            },
                            "stacked": {
                              "type": "boolean"
                            },
                            "errorBars": {
                              "type": "boolean"
                            },
                            "invertYAxis": {
                              "type": "boolean"
                            },
                            "logYAxis": {
                              "type": "boolean"
                            },
                            "orientation": {
                              "type": "string",
                              "enum": [
                                "h",
                                "v"
                              ]
                            },
                            "donutHoleSize": {
                              "type": "number",
                              "minimum": 0,
                              "maximum": 1
                            },
                            "showTotal": {
                              "type": "boolean"
                            },
                            "textSize": {
                              "type": "number",
                              "exclusiveMinimum": 0
                            },
                            "aggregate": {
                              "type": "string"
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "required": [
                        "table",
                        "widget_type"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                "required": [
                  "pattern",
                  "charts"
                ],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "pattern": {
                    "type": "string",
                    "const": "form_table"
                  },
                  "form": {
                    "type": "object",
                    "properties": {
                      "table": {
                        "description": "Data table name for this widget",
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 64,
                        "pattern": "^[A-Z_][A-Za-z0-9_]*$"
                      },
                      "widget_type": {
                        "type": "string",
                        "const": "form"
                      },
                      "title": {
                        "description": "Widget title (defaults to table name)",
                        "type": "string"
                      },
                      "description": {
                        "description": "Widget description",
                        "type": "string"
                      },
                      "fields": {
                        "description": "Form fields to display (column names)",
                        "type": "array",
                        "items": {
                          "type": "string"
                        }
                      }
                    },
                    "required": [
                      "table",
                      "widget_type"
                    ],
                    "additionalProperties": false
                  },
                  "table": {
                    "type": "object",
                    "properties": {
                      "table": {
                        "description": "Data table name for this widget",
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 64,
                        "pattern": "^[A-Z_][A-Za-z0-9_]*$"
                      },
                      "widget_type": {
                        "default": "grid",
                        "type": "string",
                        "enum": [
                          "grid",
                          "card_list"
                        ]
                      },
                      "title": {
                        "description": "Widget title (defaults to table name)",
                        "type": "string"
                      },
                      "description": {
                        "description": "Widget description",
                        "type": "string"
                      }
                    },
                    "required": [
                      "table"
                    ],
                    "additionalProperties": false
                  },
                  "split": {
                    "description": "Split direction",
                    "default": "vertical",
                    "type": "string",
                    "enum": [
                      "horizontal",
                      "vertical"
                    ]
                  }
                },
                "required": [
                  "pattern",
                  "form",
                  "table"
                ],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "pattern": {
                    "type": "string",
                    "const": "custom"
                  },
                  "widgets": {
                    "description": "Widget configurations (1-10 widgets)",
                    "minItems": 1,
                    "maxItems": 10,
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "table": {
                          "description": "Data table name for this widget",
                          "type": "string",
                          "minLength": 1,
                          "maxLength": 64,
                          "pattern": "^[A-Z_][A-Za-z0-9_]*$"
                        },
                        "widget_type": {
                          "description": "Widget display type (grid, card, card_list, chart, form, custom)",
                          "default": "grid",
                          "type": "string",
                          "enum": [
                            "grid",
                            "card",
                            "card_list",
                            "chart",
                            "form",
                            "custom"
                          ]
                        },
                        "title": {
                          "description": "Widget title (defaults to table name)",
                          "type": "string"
                        },
                        "description": {
                          "description": "Widget description",
                          "type": "string"
                        },
                        "link_to": {
                          "description": "Name of widget to link to (for master-detail relationships)",
                          "type": "string"
                        },
                        "link_field": {
                          "description": "Reference column for linking",
                          "anyOf": [
                            {
                              "type": "string"
                            },
                            {
                              "type": "number"
                            }
                          ]
                        }
                      },
                      "required": [
                        "table"
                      ],
                      "additionalProperties": false
                    }
                  },
                  "layout": {
                    "description": "Custom layout specification. If omitted, widgets are arranged in default grid",
                    "allOf": [
                      {
                        "$ref": "#/definitions/__schema0"
                      }
                    ]
                  }
                },
                "required": [
                  "pattern",
                  "widgets"
                ],
                "additionalProperties": false
              }
            ]
          },
          "response_format": {
            "default": "markdown",
            "description": "Output format: \"json\" for structured data, \"markdown\" for human-readable text",
            "type": "string",
            "enum": [
              "json",
              "markdown"
            ]
          }
        },
        "required": [
          "docId",
          "page_name",
          "config"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false,
        "definitions": {
          "__schema0": {
            "oneOf": [
              {
                "type": "object",
                "properties": {
                  "type": {
                    "type": "string",
                    "const": "leaf"
                  },
                  "leaf": {
                    "description": "Widget ID (sectionId)",
                    "type": "integer",
                    "exclusiveMinimum": 0,
                    "maximum": 9007199254740991
                  }
                },
                "required": [
                  "type",
                  "leaf"
                ],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "type": {
                    "type": "string",
                    "const": "hsplit"
                  },
                  "children": {
                    "description": "Child layouts (at least 2 required)",
                    "minItems": 2,
                    "maxItems": 10,
                    "type": "array",
                    "items": {
                      "$ref": "#/definitions/__schema0"
                    }
                  },
                  "splitRatio": {
                    "description": "Split ratio (0.1-0.9, default: 0.5)",
                    "default": 0.5,
                    "type": "number",
                    "minimum": 0.1,
                    "maximum": 0.9
                  }
                },
                "required": [
                  "type",
                  "children"
                ],
                "additionalProperties": false
              },
              {
                "type": "object",
                "properties": {
                  "type": {
                    "type": "string",
                    "const": "vsplit"
                  },
                  "children": {
                    "description": "Child layouts (at least 2 required)",
                    "minItems": 2,
                    "maxItems": 10,
                    "type": "array",
                    "items": {
                      "$ref": "#/definitions/__schema0"
                    }
                  },
                  "splitRatio": {
                    "description": "Split ratio (0.1-0.9, default: 0.5)",
                    "default": 0.5,
                    "type": "number",
                    "minimum": 0.1,
                    "maximum": 0.9
                  }
                },
                "required": [
                  "type",
                  "children"
                ],
                "additionalProperties": false
              }
            ]
          }
        }
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "const": true
          },
          "page_name": {
            "description": "Page name",
            "type": "string"
          },
          "view_id": {
            "description": "Created page/view ID",
            "type": "number"
          },
          "pattern": {
            "description": "Page pattern used",
            "type": "string"
          },
          "description": {
            "description": "Description of created page",
            "type": "string"
          },
          "widgets": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "section_id": {
                  "description": "Widget section ID",
                  "type": "number"
                },
                "table_ref": {
                  "description": "Table reference ID",
                  "type": "number"
                },
                "position": {
                  "description": "Widget position",
                  "type": "string"
                },
                "title": {
                  "description": "Widget title",
                  "type": "string"
                }
              },
              "required": [
                "section_id",
                "table_ref"
              ],
              "additionalProperties": false
            }
          }
        },
        "required": [
          "success",
          "page_name",
          "view_id",
          "pattern",
          "description",
          "widgets"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "annotations": {
        "readOnlyHint": false,
        "destructiveHint": false,
        "idempotentHint": false,
        "openWorldHint": true
      },
      "execution": {
        "taskSupport": "forbidden"
      }
    },
    {
      "name": "grist_configure_widget",
      "title": "Configure Widget",
      "description": "Configure widget properties, linking, sorting, and filtering",
      "inputSchema": {
        "type": "object",
        "properties": {
          "docId": {
            "description": "Document ID from grist_get_documents. Examples: \"aKt7TZe8YGLp3ak8bDL8TZ\", \"qBbArddFDSrKd2jpv3uZTj\", \"xYz9123AbcDef456Ghi78J\"",
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "pattern": "^[1-9A-HJ-NP-Za-km-z]{22}$"
          },
          "operations": {
            "description": "Widget operations to perform (1-50 operations, executed in order)",
            "minItems": 1,
            "maxItems": 50,
            "type": "array",
            "items": {
              "oneOf": [
                {
                  "type": "object",
                  "properties": {
                    "action": {
                      "type": "string",
                      "const": "add"
                    },
                    "page_name": {
                      "description": "Page name where widget will be added",
                      "type": "string",
                      "minLength": 1
                    },
                    "table": {
                      "description": "Data table for the new widget",
                      "type": "string",
                      "minLength": 1,
                      "maxLength": 64,
                      "pattern": "^[A-Z_][A-Za-z0-9_]*$"
                    },
                    "widget_type": {
                      "description": "Widget display type (grid, card, card_list, chart, form, custom)",
                      "default": "grid",
                      "type": "string",
                      "enum": [
                        "grid",
                        "card",
                        "card_list",
                        "chart",
                        "form",
                        "custom"
                      ]
                    },
                    "title": {
                      "description": "Widget title",
                      "type": "string"
                    },
                    "description": {
                      "description": "Widget description",
                      "type": "string"
                    },
                    "position": {
                      "description": "Where to add widget relative to existing layout",
                      "default": "right",
                      "type": "string",
                      "enum": [
                        "right",
                        "bottom",
                        "replace"
                      ]
                    }
                  },
                  "required": [
                    "action",
                    "page_name",
                    "table"
                  ],
                  "additionalProperties": false
                },
                {
                  "type": "object",
                  "properties": {
                    "action": {
                      "type": "string",
                      "const": "modify"
                    },
                    "page_name": {
                      "description": "Page name containing the widget",
                      "type": "string",
                      "minLength": 1
                    },
                    "widget": {
                      "description": "Widget name or ID to modify",
                      "anyOf": [
                        {
                          "type": "string",
                          "minLength": 1
                        },
                        {
                          "type": "integer",
                          "exclusiveMinimum": 0,
                          "maximum": 9007199254740991
                        }
                      ]
                    },
                    "widget_type": {
                      "description": "Change widget type",
                      "type": "string",
                      "enum": [
                        "grid",
                        "card",
                        "card_list",
                        "chart",
                        "form",
                        "custom"
                      ]
                    },
                    "table": {
                      "description": "Change data source table",
                      "type": "string",
                      "minLength": 1,
                      "maxLength": 64,
                      "pattern": "^[A-Z_][A-Za-z0-9_]*$"
                    },
                    "title": {
                      "description": "Update widget title",
                      "type": "string"
                    },
                    "description": {
                      "description": "Update widget description",
                      "type": "string"
                    },
                    "visible_fields": {
                      "description": "Set visible fields/columns (replaces current visibility)",
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  },
                  "required": [
                    "action",
                    "page_name",
                    "widget"
                  ],
                  "additionalProperties": false
                },
                {
                  "type": "object",
                  "properties": {
                    "action": {
                      "type": "string",
                      "const": "link"
                    },
                    "page_name": {
                      "description": "Page name containing the widgets",
                      "type": "string",
                      "minLength": 1
                    },
                    "target_widget": {
                      "description": "Target widget name or ID (detail widget)",
                      "anyOf": [
                        {
                          "type": "string",
                          "minLength": 1
                        },
                        {
                          "type": "integer",
                          "exclusiveMinimum": 0,
                          "maximum": 9007199254740991
                        }
                      ]
                    },
                    "link_config": {
                      "type": "object",
                      "properties": {
                        "source_widget": {
                          "description": "Source widget name or ID (the selector/master widget)",
                          "anyOf": [
                            {
                              "type": "string",
                              "minLength": 1
                            },
                            {
                              "type": "integer",
                              "exclusiveMinimum": 0,
                              "maximum": 9007199254740991
                            }
                          ]
                        },
                        "target_col": {
                          "description": "Target column name/ID for link. Use 0 or omit for table-level link (entire record)",
                          "anyOf": [
                            {
                              "type": "string"
                            },
                            {
                              "type": "number"
                            },
                            {
                              "type": "number",
                              "const": 0
                            }
                          ]
                        },
                        "source_col": {
                          "description": "Source column name/ID for link. Use 0 or omit for table-level link (entire record)",
                          "anyOf": [
                            {
                              "type": "string"
                            },
                            {
                              "type": "number"
                            },
                            {
                              "type": "number",
                              "const": 0
                            }
                          ]
                        }
                      },
                      "required": [
                        "source_widget"
                      ],
                      "additionalProperties": false
                    }
                  },
                  "required": [
                    "action",
                    "page_name",
                    "target_widget",
                    "link_config"
                  ],
                  "additionalProperties": false
                },
                {
                  "type": "object",
                  "properties": {
                    "action": {
                      "type": "string",
                      "const": "sort"
                    },
                    "page_name": {
                      "description": "Page name containing the widget",
                      "type": "string",
                      "minLength": 1
                    },
                    "widget": {
                      "description": "Widget name or ID to configure sorting",
                      "anyOf": [
                        {
                          "type": "string",
                          "minLength": 1
                        },
                        {
                          "type": "integer",
                          "exclusiveMinimum": 0,
                          "maximum": 9007199254740991
                        }
                      ]
                    },
                    "sort_spec": {
                      "anyOf": [
                        {
                          "description": "Array of column IDs: [2] ascending, [-2] descending, [3, -5] multiple",
                          "type": "array",
                          "items": {
                            "type": "integer",
                            "minimum": -9007199254740991,
                            "maximum": 9007199254740991
                          }
                        },
                        {
                          "description": "Array of column names or IDs with optional flags. Use column names: [\"Name\", \"-Price\"] or IDs: [\"3\", \"-5\"]. Prefix with \"-\" for descending. Suffix with flags: [\"Name:emptyLast\", \"-Price:naturalSort\"]. Valid flags: emptyLast, naturalSort, orderByChoice",
                          "type": "array",
                          "items": {
                            "type": "string"
                          }
                        }
                      ]
                    }
                  },
                  "required": [
                    "action",
                    "page_name",
                    "widget",
                    "sort_spec"
                  ],
                  "additionalProperties": false
                },
                {
                  "type": "object",
                  "properties": {
                    "action": {
                      "type": "string",
                      "const": "filter"
                    },
                    "page_name": {
                      "description": "Page name containing the widget",
                      "type": "string",
                      "minLength": 1
                    },
                    "widget": {
                      "description": "Widget name or ID to configure filtering",
                      "anyOf": [
                        {
                          "type": "string",
                          "minLength": 1
                        },
                        {
                          "type": "integer",
                          "exclusiveMinimum": 0,
                          "maximum": 9007199254740991
                        }
                      ]
                    },
                    "column": {
                      "description": "Column name to filter",
                      "type": "string",
                      "minLength": 1
                    },
                    "filter_spec": {
                      "type": "object",
                      "properties": {
                        "included": {
                          "description": "Values to include (whitelist)",
                          "type": "array",
                          "items": {
                            "anyOf": [
                              {
                                "type": "string"
                              },
                              {
                                "type": "number"
                              },
                              {
                                "type": "boolean"
                              },
                              {
                                "type": "null"
                              }
                            ]
                          }
                        },
                        "excluded": {
                          "description": "Values to exclude (blacklist)",
                          "type": "array",
                          "items": {
                            "anyOf": [
                              {
                                "type": "string"
                              },
                              {
                                "type": "number"
                              },
                              {
                                "type": "boolean"
                              },
                              {
                                "type": "null"
                              }
                            ]
                          }
                        }
                      },
                      "additionalProperties": false
                    },
                    "pinned": {
                      "description": "Pin filter to filter bar (visible in UI, default: false)",
                      "default": false,
                      "type": "boolean"
                    }
                  },
                  "required": [
                    "action",
                    "page_name",
                    "widget",
                    "column",
                    "filter_spec"
                  ],
                  "additionalProperties": false
                },
                {
                  "type": "object",
                  "properties": {
                    "action": {
                      "type": "string",
                      "const": "delete"
                    },
                    "page_name": {
                      "description": "Page name containing the widget",
                      "type": "string",
                      "minLength": 1
                    },
                    "widget": {
                      "description": "Widget name or ID to delete",
                      "anyOf": [
                        {
                          "type": "string",
                          "minLength": 1
                        },
                        {
                          "type": "integer",
                          "exclusiveMinimum": 0,
                          "maximum": 9007199254740991
                        }
                      ]
                    }
                  },
                  "required": [
                    "action",
                    "page_name",
                    "widget"
                  ],
                  "additionalProperties": false
                }
              ]
            }
          },
          "response_format": {
            "default": "markdown",
            "description": "Output format: \"json\" for structured data, \"markdown\" for human-readable text",
            "type": "string",
            "enum": [
              "json",
              "markdown"
            ]
          }
        },
        "required": [
          "docId",
          "operations"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "const": true
          },
          "operations_completed": {
            "description": "Number of operations completed",
            "type": "number"
          },
          "summary": {
            "description": "Summary of each operation",
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        },
        "required": [
          "success",
          "operations_completed",
          "summary"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "annotations": {
        "readOnlyHint": false,
        "destructiveHint": false,
        "idempotentHint": false,
        "openWorldHint": true
      },
      "execution": {
        "taskSupport": "forbidden"
      }
    },
    {
      "name": "grist_update_page",
      "title": "Update Page",
      "description": "Rename, reorder, or delete pages",
      "inputSchema": {
        "type": "object",
        "properties": {
          "docId": {
            "description": "Document ID from grist_get_documents. Examples: \"aKt7TZe8YGLp3ak8bDL8TZ\", \"qBbArddFDSrKd2jpv3uZTj\", \"xYz9123AbcDef456Ghi78J\"",
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "pattern": "^[1-9A-HJ-NP-Za-km-z]{22}$"
          },
          "operations": {
            "description": "Page operations to perform (1-50 operations, executed in order)",
            "minItems": 1,
            "maxItems": 50,
            "type": "array",
            "items": {
              "oneOf": [
                {
                  "type": "object",
                  "properties": {
                    "action": {
                      "type": "string",
                      "const": "rename"
                    },
                    "page_name": {
                      "description": "Current page name",
                      "type": "string",
                      "minLength": 1
                    },
                    "new_name": {
                      "description": "New page name",
                      "type": "string",
                      "minLength": 1,
                      "maxLength": 255
                    }
                  },
                  "required": [
                    "action",
                    "page_name",
                    "new_name"
                  ],
                  "additionalProperties": false
                },
                {
                  "type": "object",
                  "properties": {
                    "action": {
                      "type": "string",
                      "const": "reorder"
                    },
                    "page_name": {
                      "description": "Page name to reorder",
                      "type": "string",
                      "minLength": 1
                    },
                    "position": {
                      "anyOf": [
                        {
                          "description": "Absolute position (0-indexed)",
                          "type": "integer",
                          "minimum": 0,
                          "maximum": 9007199254740991
                        },
                        {
                          "type": "object",
                          "properties": {
                            "before": {
                              "description": "Place before this page",
                              "type": "string",
                              "minLength": 1
                            }
                          },
                          "required": [
                            "before"
                          ]
                        },
                        {
                          "type": "object",
                          "properties": {
                            "after": {
                              "description": "Place after this page",
                              "type": "string",
                              "minLength": 1
                            }
                          },
                          "required": [
                            "after"
                          ]
                        }
                      ]
                    }
                  },
                  "required": [
                    "action",
                    "page_name",
                    "position"
                  ],
                  "additionalProperties": false
                },
                {
                  "type": "object",
                  "properties": {
                    "action": {
                      "type": "string",
                      "const": "delete"
                    },
                    "page_name": {
                      "description": "Page name to delete",
                      "type": "string",
                      "minLength": 1
                    },
                    "delete_data": {
                      "description": "Delete underlying data tables (default: false, only deletes view). WARNING: Permanent data loss",
                      "default": false,
                      "type": "boolean"
                    }
                  },
                  "required": [
                    "action",
                    "page_name"
                  ],
                  "additionalProperties": false
                }
              ]
            }
          },
          "response_format": {
            "default": "markdown",
            "description": "Output format: \"json\" for structured data, \"markdown\" for human-readable text",
            "type": "string",
            "enum": [
              "json",
              "markdown"
            ]
          }
        },
        "required": [
          "docId",
          "operations"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "const": true
          },
          "operations_completed": {
            "description": "Number of operations completed",
            "type": "number"
          },
          "summary": {
            "description": "Summary of each operation",
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        },
        "required": [
          "success",
          "operations_completed",
          "summary"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "annotations": {
        "readOnlyHint": false,
        "destructiveHint": false,
        "idempotentHint": false,
        "openWorldHint": true
      },
      "execution": {
        "taskSupport": "forbidden"
      }
    },
    {
      "name": "grist_manage_webhooks",
      "title": "Manage Webhooks",
      "description": "Create, update, delete, or list webhooks for real-time notifications",
      "inputSchema": {
        "type": "object",
        "properties": {
          "docId": {
            "description": "Document ID from grist_get_documents. Examples: \"aKt7TZe8YGLp3ak8bDL8TZ\", \"qBbArddFDSrKd2jpv3uZTj\", \"xYz9123AbcDef456Ghi78J\"",
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "pattern": "^[1-9A-HJ-NP-Za-km-z]{22}$"
          },
          "operation": {
            "description": "Webhook operation to perform: list, create, update, delete, or clear_queue",
            "oneOf": [
              {
                "description": "List all webhooks for a document with usage statistics",
                "type": "object",
                "properties": {
                  "action": {
                    "type": "string",
                    "const": "list"
                  },
                  "offset": {
                    "description": "Starting position for pagination (default: 0)",
                    "default": 0,
                    "type": "integer",
                    "minimum": 0,
                    "maximum": 9007199254740991
                  },
                  "limit": {
                    "description": "Maximum webhooks to return (default: 100, max: 1000)",
                    "default": 100,
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 1000
                  }
                },
                "required": [
                  "action"
                ],
                "additionalProperties": false
              },
              {
                "description": "Create a new webhook subscription for table changes",
                "type": "object",
                "properties": {
                  "action": {
                    "type": "string",
                    "const": "create"
                  },
                  "fields": {
                    "type": "object",
                    "properties": {
                      "name": {
                        "description": "Human-readable name for the webhook (1-255 characters)",
                        "anyOf": [
                          {
                            "type": "string",
                            "minLength": 1,
                            "maxLength": 255
                          },
                          {
                            "type": "null"
                          }
                        ]
                      },
                      "memo": {
                        "description": "Description or notes about the webhook (max 1000 characters)",
                        "anyOf": [
                          {
                            "type": "string",
                            "maxLength": 1000
                          },
                          {
                            "type": "null"
                          }
                        ]
                      },
                      "url": {
                        "description": "URL endpoint that will receive webhook POST requests with event data. Must be publicly accessible and in the server's ALLOWED_WEBHOOK_DOMAINS list. (HTTPS recommended for security).",
                        "type": "string",
                        "maxLength": 2000,
                        "format": "uri"
                      },
                      "enabled": {
                        "description": "Whether the webhook is active. Default: true if omitted",
                        "type": "boolean"
                      },
                      "eventTypes": {
                        "description": "Array of event types that trigger this webhook: \"add\", \"update\"",
                        "minItems": 1,
                        "type": "array",
                        "items": {
                          "type": "string",
                          "enum": [
                            "add",
                            "update"
                          ]
                        }
                      },
                      "isReadyColumn": {
                        "description": "Optional column ID. Webhook only fires when this column has a truthy value. Column must exist in the target table. Use for conditional webhooks (e.g., only send webhook when Status=\"Approved\").",
                        "anyOf": [
                          {
                            "type": "string",
                            "minLength": 1,
                            "maxLength": 64,
                            "pattern": "^[A-Za-z_][A-Za-z0-9_]*$"
                          },
                          {
                            "type": "null"
                          }
                        ]
                      },
                      "tableId": {
                        "description": "Table name from grist_get_tables. Examples: \"Contacts\", \"Sales_Data\", \"Projects\", \"Inventory\", \"Customers\"",
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 64,
                        "pattern": "^[A-Z_][A-Za-z0-9_]*$"
                      }
                    },
                    "required": [
                      "url",
                      "eventTypes",
                      "tableId"
                    ],
                    "additionalProperties": false
                  }
                },
                "required": [
                  "action",
                  "fields"
                ],
                "additionalProperties": false
              },
              {
                "description": "Update an existing webhook configuration",
                "type": "object",
                "properties": {
                  "action": {
                    "type": "string",
                    "const": "update"
                  },
                  "webhookId": {
                    "description": "UUID of the webhook",
                    "type": "string",
                    "format": "uuid",
                    "pattern": "^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$"
                  },
                  "fields": {
                    "description": "Fields to update. Only provided fields will be modified",
                    "type": "object",
                    "properties": {
                      "name": {
                        "description": "Human-readable name for the webhook (1-255 characters)",
                        "anyOf": [
                          {
                            "type": "string",
                            "minLength": 1,
                            "maxLength": 255
                          },
                          {
                            "type": "null"
                          }
                        ]
                      },
                      "memo": {
                        "description": "Description or notes about the webhook (max 1000 characters)",
                        "anyOf": [
                          {
                            "type": "string",
                            "maxLength": 1000
                          },
                          {
                            "type": "null"
                          }
                        ]
                      },
                      "url": {
                        "description": "URL endpoint that will receive webhook POST requests with event data. Must be publicly accessible and in the server's ALLOWED_WEBHOOK_DOMAINS list. (HTTPS recommended for security).",
                        "type": "string",
                        "maxLength": 2000,
                        "format": "uri"
                      },
                      "enabled": {
                        "description": "Whether the webhook is active.",
                        "type": "boolean"
                      },
                      "eventTypes": {
                        "description": "Array of event types that trigger this webhook: \"add\", \"update\"",
                        "minItems": 1,
                        "type": "array",
                        "items": {
                          "type": "string",
                          "enum": [
                            "add",
                            "update"
                          ]
                        }
                      },
                      "isReadyColumn": {
                        "description": "Optional column ID. Webhook only fires when this column has a truthy value. Column must exist in the target table. Use for conditional webhooks (e.g., only send webhook when Status=\"Approved\").",
                        "anyOf": [
                          {
                            "type": "string",
                            "minLength": 1,
                            "maxLength": 64,
                            "pattern": "^[A-Za-z_][A-Za-z0-9_]*$"
                          },
                          {
                            "type": "null"
                          }
                        ]
                      },
                      "tableId": {
                        "description": "Table name from grist_get_tables. Examples: \"Contacts\", \"Sales_Data\", \"Projects\", \"Inventory\", \"Customers\"",
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 64,
                        "pattern": "^[A-Z_][A-Za-z0-9_]*$"
                      }
                    },
                    "additionalProperties": false
                  }
                },
                "required": [
                  "action",
                  "webhookId",
                  "fields"
                ],
                "additionalProperties": false
              },
              {
                "description": "Delete a webhook subscription permanently",
                "type": "object",
                "properties": {
                  "action": {
                    "type": "string",
                    "const": "delete"
                  },
                  "webhookId": {
                    "description": "UUID of the webhook",
                    "type": "string",
                    "format": "uuid",
                    "pattern": "^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$"
                  }
                },
                "required": [
                  "action",
                  "webhookId"
                ],
                "additionalProperties": false
              },
              {
                "description": "Clear all pending webhook payloads in the queue. WARNING: This is destructive and cannot be undone. Use when webhook queue has backed up due to endpoint failures.",
                "type": "object",
                "properties": {
                  "action": {
                    "type": "string",
                    "const": "clear_queue"
                  }
                },
                "required": [
                  "action"
                ],
                "additionalProperties": false
              }
            ]
          },
          "response_format": {
            "description": "Output format: \"json\" for structured data, \"markdown\" for human-readable text",
            "default": "markdown",
            "type": "string",
            "enum": [
              "json",
              "markdown"
            ]
          }
        },
        "required": [
          "docId",
          "operation"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "operation": {
            "type": "string",
            "enum": [
              "list",
              "create",
              "update",
              "delete",
              "clear_queue"
            ]
          },
          "document_id": {
            "description": "Document ID",
            "type": "string"
          }
        },
        "required": [
          "operation",
          "document_id"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": {}
      },
      "annotations": {
        "readOnlyHint": false,
        "destructiveHint": false,
        "idempotentHint": false,
        "openWorldHint": true
      },
      "execution": {
        "taskSupport": "forbidden"
      }
    },
    {
      "name": "grist_help",
      "title": "Get Tool Help",
      "description": "Get documentation for any Grist tool.\nTopics: overview (~500B), examples, errors, parameters, full (default)\nParams: tool_name, topic (optional)\nEx: {tool_name:\"grist_add_records\",topic:\"errors\"}\nUse topic=\"overview\" for quick help, \"errors\" when troubleshooting.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "tool_name": {
            "description": "Name of the Grist tool to get detailed documentation for. Example: \"grist_get_records\", \"grist_add_records\", \"grist_upsert_records\"",
            "type": "string",
            "enum": [
              "grist_get_workspaces",
              "grist_get_documents",
              "grist_get_tables",
              "grist_query_sql",
              "grist_get_records",
              "grist_add_records",
              "grist_update_records",
              "grist_upsert_records",
              "grist_delete_records",
              "grist_create_table",
              "grist_rename_table",
              "grist_delete_table",
              "grist_create_summary_table",
              "grist_manage_columns",
              "grist_manage_conditional_rules",
              "grist_create_document",
              "grist_get_pages",
              "grist_build_page",
              "grist_configure_widget",
              "grist_update_page",
              "grist_manage_webhooks",
              "grist_help"
            ]
          },
          "topic": {
            "description": "Filter documentation by topic: \"overview\" (~500B quick summary), \"examples\" (~800B code samples), \"errors\" (~400B troubleshooting), \"parameters\" (~600B detailed params), \"full\" (complete docs, default)",
            "default": "full",
            "type": "string",
            "enum": [
              "overview",
              "examples",
              "errors",
              "parameters",
              "full"
            ]
          },
          "response_format": {
            "description": "Output format: \"json\" for structured data, \"markdown\" for human-readable text",
            "default": "markdown",
            "type": "string",
            "enum": [
              "json",
              "markdown"
            ]
          }
        },
        "required": [
          "tool_name"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "outputSchema": {
        "type": "object",
        "properties": {
          "tool_name": {
            "description": "Tool name",
            "type": "string"
          },
          "topic": {
            "description": "Documentation topic",
            "type": "string"
          },
          "documentation": {
            "description": "Documentation content",
            "type": "string"
          },
          "available_topics": {
            "description": "Available help topics",
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        },
        "required": [
          "tool_name",
          "topic",
          "documentation",
          "available_topics"
        ],
        "$schema": "http://json-schema.org/draft-07/schema#",
        "additionalProperties": false
      },
      "annotations": {
        "readOnlyHint": true,
        "destructiveHint": false,
        "idempotentHint": true,
        "openWorldHint": true
      },
      "execution": {
        "taskSupport": "forbidden"
      }
    }
  ]
}
